<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.49" />
    <meta name="description" content="KUBEDGE">
<meta name="author" content="Kubedge Team">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />
    <title>Enable docker Remote API :: KUBEDGE&#39;s Blog</title>

    
    <link href="/css/nucleus.css?1540673754" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1540673754" rel="stylesheet">
    <link href="/css/hybrid.css?1540673754" rel="stylesheet">
    <link href="/css/featherlight.min.css?1540673754" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1540673754" rel="stylesheet">
    <link href="/css/auto-complete.css?1540673754" rel="stylesheet">
    <link href="/css/theme.css?1540673754" rel="stylesheet">
    <link href="/css/hugo-theme.css?1540673754" rel="stylesheet">
    
      <link href="/css/theme-kubedge.css?1540673754" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1540673754"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/pi_cluster/docker_kubernetes/children/2018-07-12-a/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="">
  <svg id="grav-logo" width="100%" height="100%" viewBox="0 0 504 140" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
    <path d="M235.832,71.564l-7.98,-0.001c-1.213,0.001 -2.197,0.987 -2.197,2.204l0,15.327l-0.158,0.132c-4.696,3.962 -10.634,6.14 -16.719,6.14c-14.356,0 -26.034,-11.68 -26.034,-26.037c0,-14.358 11.678,-26.035 26.034,-26.035c5.582,0 10.919,1.767 15.437,5.113c0.877,0.649 2.093,0.56 2.866,-0.211l5.69,-5.69c0.444,-0.442 0.675,-1.055 0.639,-1.681c-0.034,-0.627 -0.336,-1.206 -0.828,-1.597c-6.76,-5.363 -15.214,-8.314 -23.805,-8.314c-21.18,0 -38.414,17.233 -38.414,38.415c0,21.183 17.234,38.415 38.414,38.415c10.937,0 21.397,-4.705 28.698,-12.914c0.358,-0.403 0.556,-0.921 0.556,-1.46l0,-19.603c0,-1.217 -0.985,-2.203 -2.2,-2.203"
      style="fill:#000;fill-rule:nonzero;"></path>
  </svg>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1540673754"></script>
<script type="text/javascript" src="/js/auto-complete.js?1540673754"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="/js/search.js?1540673754"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/post/" title="Latest News" class="dd-item 
        
        
        
        ">
      <a href="/post/">
          Latest News
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/devops/" title="DevOps" class="dd-item 
        
        
        
        ">
      <a href="/devops/">
          <b>1. </b>DevOps
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/devops/git_gerrit/" title="Git/Gerrit" class="dd-item 
        
        
        
        ">
      <a href="/devops/git_gerrit/">
          <b>1.1. </b>Git &amp; Gerrit
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/2018-06-25-a/" title="Setup github/gerrit behind a corporate http proxy" class="dd-item ">
        <a href="/devops/git_gerrit/children/2018-06-25-a/">
        Corporate Proxy
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/2018-06-23-a/" title="Setup multiple GitHub account on a single machine" class="dd-item ">
        <a href="/devops/git_gerrit/children/2018-06-23-a/">
        Multiple GitHub accounts
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/cicd/" title="CI/CD" class="dd-item 
        
        
        
        ">
      <a href="/devops/cicd/">
          <b>1.2. </b>CI/CD
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/hugo_githubpages/" title="Hugo/GitHubPages" class="dd-item 
        
        
        
        ">
      <a href="/devops/hugo_githubpages/">
          <b>1.3. </b>Hugo &amp; GitHub pages
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/kubedgesdk/" title="Kubedge SDK" class="dd-item 
        
        
        
        ">
      <a href="/devops/kubedgesdk/">
          <b>1.4. </b>Kubedge SDK
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/kubedgesdk/children/2018-07-15-a/" title="Recompile Kubernetes components for Raspberry PI" class="dd-item ">
        <a href="/devops/kubedgesdk/children/2018-07-15-a/">
        Kubernetes cross-compilation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/kubedgesdk/children/2018-06-21-a/" title="Setup SingleNode Kubernetes Cluster using kubeadm" class="dd-item ">
        <a href="/devops/kubedgesdk/children/2018-06-21-a/">
        SingleNode Kubernetes
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/devops/advanced/">
          <b>1.5. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/advanced/children/2018-07-16-a/" title="Rebuild Hyperkube images" class="dd-item ">
        <a href="/devops/advanced/children/2018-07-16-a/">
        Hyperkube images
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/advanced/children/2018-06-26-a/" title="Zuul" class="dd-item ">
        <a href="/devops/advanced/children/2018-06-26-a/">
        Zuul
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pi_cluster/" title="RPI Cluster" class="dd-item 
        parent
        
        
        ">
      <a href="/pi_cluster/">
          <b>2. </b>RPI Cluster
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/os_installation/" title="Operating System" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/os_installation/">
          <b>2.1. </b>Operating System
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/cluster_assembly/" title="Raspberry PI cluster Assembly" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/cluster_assembly/">
        HW Assembly
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/ansible/" title="Using Ansible to manage Raspberry PI cluster" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/ansible/">
        Ansible
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/dongle/" title="Create a Rapsberry PI Rescue Dongle" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/dongle/">
        Rescue Dongle
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/docker_kubernetes/" title="Kubernetes" class="dd-item 
        parent
        
        
        ">
      <a href="/pi_cluster/docker_kubernetes/">
          <b>2.2. </b>Kubernetes
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-30-a/" title="Build and Deploy Kubernetes test-infra" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-30-a/">
        Test-Infra
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-14-a/" title="Deploy Flannel in PI Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-14-a/">
        Flannel
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-13-a/" title="Deply Helm and Tiller on PI Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-13-a/">
        Helm and Tiller
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-12-a/" title="Enable docker Remote API" class="dd-item active">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-12-a/">
        Docker Remote API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-08-a/" title="Add Persistency Volume to PI Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-08-a/">
        Persistency Volume
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-03-a/" title="Creating a Raspberry 3 B&#43; Kubernetes Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-03-a/">
        Installation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-06-24-a/" title="docker.io versus docker-ce" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-06-24-a/">
        Docker
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-06-19-a/" title="Add Raspberry PI node to Kubernetes Cluster in 10 min" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-06-19-a/">
        Add a node
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/maintenance/" title="Helm &amp; Maintenance" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/maintenance/">
          <b>2.3. </b>Helm &amp; Maintenance
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-09-28-a/" title="Upgrade RPI Kubernetes cluster to 1.12" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-09-28-a/">
        Upgrade to K8s 1.12
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-07-11-a/" title="Use github repo as helm chart repository" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-07-11-a/">
        Helm charts repo
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-07-02-a/" title="Compile and Test SONOBUOY" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-07-02-a/">
        Sonobuoy
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-06-30-a/" title="Update Kubernetes to 1.11 on Ubuntu" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-06-30-a/">
        Upgrade to K8s 1.11
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/microservices/" title="MicroServices" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/microservices/">
          <b>2.4. </b>MicroServices
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-07-01-a/" title="Python" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-07-01-a/">
        Python
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-06-29-a/" title="Creating simple GO server container" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-06-29-a/">
        GO
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-06-28-a/" title="Creating simple Java 10 server container" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-06-28-a/">
        Java 10
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-06-22-a/" title="Setup your GOLANG environment" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-06-22-a/">
        GOLANG env
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/advanced/">
          <b>2.5. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-08-01-a/" title="Build and Deploy Kubernetes Hashicorp Vault" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-08-01-a/">
        Hashicorp Vault
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-31-a/" title="Build and Deploy Kubernetes Istio" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-31-a/">
        Istio
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-29-a/" title="Build and Deploy Kubernetes Kustomize" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-29-a/">
        Kustomize
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-18-a/" title="Compile and Test Portieris" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-18-a/">
        Portieris
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/lte_to_5g/" title="LTE to 5G Simulations" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/">
          <b>3. </b>LTE to 5G Simulations
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/lte_and_5g_core_simulation/" title="EPC and 5GC" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/lte_and_5g_core_simulation/">
          <b>3.1. </b>EPC and 5GC
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/lte_and_5g_ran_simulation/" title="LTE, eLTE and 5G RAN" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/lte_and_5g_ran_simulation/">
          <b>3.2. </b>LTE, eLTE and 5G RAN
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/rpi_wifi_bluetooth/" title="Spectrum" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/rpi_wifi_bluetooth/">
          <b>3.3. </b>Spectrum
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/nsa_and_sa/" title="NSA vs SA. Option 3" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/nsa_and_sa/">
          <b>3.4. </b>NSA vs SA. Option 3
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/advanced/">
          <b>3.5. </b>Advanced &amp; WIP
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/nfv/" title="NFV/SDN/Network Slicing" class="dd-item 
        
        
        
        ">
      <a href="/nfv/">
          <b>4. </b>NFV/SDN/Network Slicing
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/nfv/fd_io_and_opnfv/" title="FD.io &amp; OPNFV" class="dd-item 
        
        
        
        ">
      <a href="/nfv/fd_io_and_opnfv/">
          <b>4.1. </b>FD.io &amp; OPNFV
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/onap/" title="ONAP" class="dd-item 
        
        
        
        ">
      <a href="/nfv/onap/">
          <b>4.2. </b>ONAP
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/akraino/" title="Akraino" class="dd-item 
        
        
        
        ">
      <a href="/nfv/akraino/">
          <b>4.3. </b>Akraino
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/nfv/advanced/">
          <b>4.5. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/nfv/advanced/children/2018-07-17-a/" title="Rebuild Calico for AMD64 ad ARM32V7" class="dd-item ">
        <a href="/nfv/advanced/children/2018-07-17-a/">
        Calico
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/about/" title="About KUBEDGE" class="dd-item 
        
        
        
        ">
      <a href="/about/">
          About KUBEDGE
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Kubedge</a> > <a href='/pi_cluster/'>RPI Cluster</a> > <a href='/pi_cluster/docker_kubernetes/'>Kubernetes</a> > Enable docker Remote API
          
         
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#generating-the-server-certs">Generating the server certs</a></li>
<li><a href="#installing-certs-and-configuring-dockerd-service">Installing certs and configuring dockerd service</a></li>
<li><a href="#installing-client-side-on-the-pi">Installing client side on the PI</a></li>
<li><a href="#installing-client-side-on-the-remove-vm">Installing client side on the remove VM</a>
<ul>
<li><a href="#reference-links">Reference Links</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Enable docker Remote API</h1>
          

        


<p>In order to build image for Raspberry PI, it is sometimes usefull to be able to leverate infrastruture from a remote VM.
For instance you can cross-build golang executable for ARM32v7 and transfer it to build an image on the remote PI.
(used for Tiller docker image)</p>

<p></p>

<h2 id="generating-the-server-certs">Generating the server certs</h2>

<p>In the case this Kubernetes cluster, the master is running on master-pi with IP address 192.168.1.95</p>

<p>as root</p>

<pre><code>mkdir -p $HOME/dockercerts
cd $HOME/dockercerts/

openssl genrsa -aes256 -out ca-key.pem 4096
openssl req -new -x509 -days 365 -key ca-key.pem -sha256 -out ca.pem
openssl genrsa -out server-key.pem 4096

export HOST=master-pi
openssl req -subj &quot;/CN=$HOST&quot; -sha256 -new -key server-key.pem -out server.csr

echo subjectAltName = DNS:$HOST,IP:192.168.1.95,IP:127.0.0.1 &gt;&gt; extfile.cnf
echo extendedKeyUsage = serverAuth &gt;&gt; extfile.cnf
openssl x509 -req -days 365 -sha256 -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem -extfile extfile. 

rm -v client.csr server.csr
chmod -v 0400 ca-key.pem key.pem server-key.pem
chmod -v 0444 ca.pem server-cert.pem cert.pem

</code></pre>

<h2 id="installing-certs-and-configuring-dockerd-service">Installing certs and configuring dockerd service</h2>

<pre><code>cp $HOME/dockercerts/ca.pem /etc/docker
cp $HOME/dockercerts/server-cert.pem /etc/docker/
cp $HOME/dockercerts/server-key.pem /etc/docker/
</code></pre>

<pre><code>mkdir -p /etc/systemd/system/docker.service.d
vi /etc/systemd/system/docker.service.d/10-tls-verify.conf

[Service]
ExecStart=
ExecStart=/usr/bin/dockerd -H fd:// -H tcp://192.168.1.95:2376 --tlsverify --tlscacert=/etc/docker/ca.pem --tlscert=/etc/docker/server-cert.pem --tlskey=/etc/docker/server-key.pem
Environment=&quot;DOCKER_OPTS=--tlsverify --tlscacert=/etc/docker/ca.pem --tlscert=/etc/docker/server-cert.pem --tlskey=/etc/docker/server-key.pem&quot;
</code></pre>

<p>Restart the service</p>

<pre><code>systemctl daemon-reload
systemctl restart docker.service
</code></pre>

<h2 id="installing-client-side-on-the-pi">Installing client side on the PI</h2>

<p>does not have to be root.</p>

<pre><code>cp /root/dockercerts/ca.pem $HOME/.docker
cp /root/dockercerts/key.pem $HOME/.docker/
cp /root/dockercerts/cert.pem $HOME/.docker/
</code></pre>

<pre><code>docker --tlsverify -H tcp://192.168.1.95:2376 --tlscacert=$HOME/.docker/ca.pem --tlscert=$HOME/.docker/cert.pem --tlskey=$HOME/.docker/key.pem images
</code></pre>

<h2 id="installing-client-side-on-the-remove-vm">Installing client side on the remove VM</h2>

<p>Transfer the key from the master-pi to the local Ubuntu VM</p>

<pre><code>mkdir -p $HOME/.docker/master-pi
cd $HOME/.docker/master-pi/
scp rpiuser@192.168.1.95:/home/rpiuser/.docker/master-pi/* .
</code></pre>

<p>Verify that the VM can access the remote PI</p>

<pre><code>docker --tlsverify -H tcp://192.168.1.95:2376 --tlscacert=$HOME/.docker/master-pi/ca.pem --tlscert=$HOME/.docker/master-pi/cert.pem --tlskey=$HOME/.docker/master-pi/key.pem version
</code></pre>

<p>Use environment variable to simplify the command line</p>

<pre><code>export DOCKER_CERT_PATH=~/.docker/master-pi
export DOCKER_HOST=tcp://192.168.1.95:2376
export DOCKER_TLS_VERIFY=1

docker ps
docker image list
</code></pre>

<h3 id="reference-links">Reference Links</h3>

<ul>
<li><a href="https://coreos.com/os/docs/latest/customizing-docker.html">coreos</a></li>
<li><a href="https://docs.docker.com/engine/reference/commandline/dockerd/#description">dockerd</a></li>
</ul>

<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/pi_cluster/docker_kubernetes/children/2018-07-13-a/" title="Deply Helm and Tiller on PI Cluster"> <i class="fas fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/pi_cluster/docker_kubernetes/children/2018-07-08-a/" title="Add Persistency Volume to PI Cluster" style="margin-right: 0px;"><i class="fas fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1540673754"></script>
    <script src="/js/perfect-scrollbar.min.js?1540673754"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1540673754"></script>
    <script src="/js/jquery.sticky.js?1540673754"></script>
    <script src="/js/featherlight.min.js?1540673754"></script>
    <script src="/js/html5shiv-printshiv.min.js?1540673754"></script>
    <script src="/js/highlight.pack.js?1540673754"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1540673754"></script>
    <script src="/js/learn.js?1540673754"></script>
    <script src="/js/hugo-learn.js?1540673754"></script>

    <link href="/mermaid/mermaid.css?1540673754" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1540673754"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

