<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.49" />
    <meta name="description" content="KUBEDGE&#39;s Blog">


    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />
    <title>Deploy Helm and Tiller on Rasberry PI Cluster :: KUBEDGE&#39;s Blog</title>

    
    <link href="/css/nucleus.css?1539654119" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1539654119" rel="stylesheet">
    <link href="/css/hybrid.css?1539654119" rel="stylesheet">
    <link href="/css/featherlight.min.css?1539654119" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1539654119" rel="stylesheet">
    <link href="/css/auto-complete.css?1539654119" rel="stylesheet">
    <link href="/css/theme.css?1539654119" rel="stylesheet">
    <link href="/css/hugo-theme.css?1539654119" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1539654119"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/pi_cluster/docker_kubernetes/children/2018-07-13-a/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://getgrav.org">
  <svg id="grav-logo" width="100%" height="100%" viewBox="0 0 504 140" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
    <path d="M235.832,71.564l-7.98,-0.001c-1.213,0.001 -2.197,0.987 -2.197,2.204l0,15.327l-0.158,0.132c-4.696,3.962 -10.634,6.14 -16.719,6.14c-14.356,0 -26.034,-11.68 -26.034,-26.037c0,-14.358 11.678,-26.035 26.034,-26.035c5.582,0 10.919,1.767 15.437,5.113c0.877,0.649 2.093,0.56 2.866,-0.211l5.69,-5.69c0.444,-0.442 0.675,-1.055 0.639,-1.681c-0.034,-0.627 -0.336,-1.206 -0.828,-1.597c-6.76,-5.363 -15.214,-8.314 -23.805,-8.314c-21.18,0 -38.414,17.233 -38.414,38.415c0,21.183 17.234,38.415 38.414,38.415c10.937,0 21.397,-4.705 28.698,-12.914c0.358,-0.403 0.556,-0.921 0.556,-1.46l0,-19.603c0,-1.217 -0.985,-2.203 -2.2,-2.203"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M502.794,34.445c-0.408,-0.616 -1.1,-0.989 -1.838,-0.989l-8.684,0c-0.879,0 -1.673,0.522 -2.022,1.329l-24.483,56.839l-24.92,-56.852c-0.352,-0.799 -1.142,-1.316 -2.012,-1.316l-8.713,0c-0.744,0 -1.44,0.373 -1.843,0.995c-0.408,0.623 -0.476,1.408 -0.174,2.09l30.186,68.858c0.352,0.799 1.143,1.317 2.017,1.317l10.992,0c0.879,0 1.673,-0.527 2.021,-1.329l29.655,-68.861c0.289,-0.68 0.222,-1.461 -0.182,-2.081"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M388.683,34.772c-0.353,-0.798 -1.142,-1.316 -2.017,-1.316l-10.988,0c-0.879,0 -1.673,0.522 -2.021,1.329l-29.655,68.861c-0.294,0.675 -0.226,1.46 0.182,2.077c0.407,0.619 1.096,0.993 1.838,0.993l8.684,0c0.879,0 1.673,-0.526 2.022,-1.329l24.478,-56.842l24.92,56.854c0.353,0.798 1.143,1.317 2.013,1.317l8.717,0c0.744,0 1.44,-0.374 1.843,-0.993c0.408,-0.624 0.471,-1.41 0.174,-2.094l-30.19,-68.857Z"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M309.196,81.525l0.476,-0.229c8.675,-4.191 14.279,-13.087 14.279,-22.667c0,-13.881 -11.295,-25.174 -25.176,-25.174l-31.863,0c-1.214,0 -2.199,0.988 -2.199,2.202l0,68.855c0,1.219 0.985,2.204 2.199,2.204l7.979,0c1.214,0 2.2,-0.985 2.2,-2.204l0,-58.679l21.684,0c7.059,0 12.799,5.739 12.799,12.796c0,5.885 -3.996,10.989 -9.728,12.408c-1.032,0.261 -2.064,0.393 -3.071,0.393l-7.977,0c-0.829,0 -1.585,0.467 -1.959,1.205c-0.378,0.74 -0.305,1.625 0.187,2.296l22.62,30.884c0.412,0.566 1.07,0.901 1.771,0.901l9.915,0c0.827,0 1.587,-0.467 1.96,-1.207c0.378,-0.742 0.302,-1.629 -0.186,-2.296l-15.91,-21.688Z"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M107.191,80.969c-7.255,-4.794 -11.4,-8.845 -15.011,-16.109c-2.47,4.977 -8.236,12.376 -17.962,18.198c-4.856,15.106 -27.954,44.015 -35.43,39.916c-2.213,-1.212 -2.633,-2.808 -2.133,-4.456c0.536,-4.129 9.078,-13.62 9.078,-13.62c0,0 0.18,1.992 2.913,6.187c-3.609,-11.205 5.965,-25.031 8.5,-29.738c3.985,-1.269 4.274,-6.387 4.274,-6.387c0.255,-7.909 -3.278,-13.635 -6.701,-17.059c2.459,3.002 3.255,7.539 3.372,11.694l0,0.023c0.012,0.469 0.012,0.93 0.011,1.39c-0.117,3.439 -1.157,8.19 -3.383,8.19l0.006,0.03c-2.289,-0.098 -5.115,0.391 -7.639,1.18l-5.582,1.334c0,0 2.977,-0.136 4.584,1.252c-1.79,2.915 -5.769,6.533 -10.206,8.588c-6.457,2.995 -8.312,-2.964 -5.034,-6.838c0.805,-0.946 1.618,-1.745 2.387,-2.399c-0.495,-0.513 -0.807,-1.198 -0.889,-2.068c-0.001,-0.005 -0.004,-0.009 -0.005,-0.013c-0.45,-1.977 -0.202,-4.543 2.596,-8.623c0.551,-0.863 1.214,-1.748 2.007,-2.647c0.025,-0.031 0.046,-0.059 0.072,-0.089c0.034,-0.042 0.072,-0.08 0.108,-0.121c0.02,-0.023 0.039,-0.045 0.059,-0.068c0.2,-0.228 0.413,-0.45 0.639,-0.663c3.334,-3.414 8.599,-6.966 16.897,-10.152c9.675,-14.223 13.219,-16.89 13.219,-16.89c1.071,-1.096 2.943,-2.458 3.632,-2.805c-5.053,-8.781 -6.074,-21.158 -4.75,-24.493c-0.107,0.18 -0.206,0.365 -0.287,0.556c0.49,-1.143 0.819,-1.509 1.328,-2.111c1.381,-1.632 6.058,-2.488 7.737,0.971c0.895,1.844 1.063,4.232 1.034,6.023c-3.704,-0.193 -7.063,4.036 -7.063,4.036c0,0 3.067,-1.448 6.879,-1.473c0,0 1.015,0.883 2.283,2.542c-1.712,3.213 -4.524,10.021 -2.488,17.168c0.338,1.408 0.849,2.619 1.483,3.648c0.024,0.045 0.044,0.089 0.069,0.135c0.051,0.066 0.096,0.122 0.144,0.183c3.368,5.072 9.542,5.665 9.542,5.665c-2.906,-1.45 -5.274,-3.76 -6.816,-6.56c-0.8,-1.498 -1.291,-2.762 -1.592,-3.761c-1.636,-6.313 0.771,-9.999 2.149,-12.471c3.17,-4.917 8.944,-7.893 15.151,-7.185c8.712,0.995 14.968,8.862 13.973,17.571c-0.608,5.321 -3.781,9.723 -8.142,12.117c1.049,2.839 -0.073,6.28 -0.073,6.28c2.642,3.323 2.758,5.238 2.667,7.017c-3.357,-0.565 -6.618,1.701 -6.618,1.701c0,0 6.476,-1.546 10.238,1.81c2.446,2.631 4.078,5.009 5.051,6.766c1.393,2.505 7.859,2.683 7.123,7.188c-0.737,4.499 -5.669,4.542 -13.401,-0.56M69.571,0c-38.424,0 -69.571,31.148 -69.571,69.567c0,38.422 31.147,69.573 69.571,69.573c38.42,0 69.568,-31.151 69.568,-69.573c0,-38.42 -31.148,-69.567 -69.568,-69.567"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M73.796,51.693c0.813,-0.814 0.813,-2.134 0,-2.947c-0.815,-0.814 -2.133,-0.814 -2.947,0c-0.815,0.813 -0.815,2.133 0,2.947c0.814,0.813 2.132,0.813 2.947,0" style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M66.445,53.149c-0.814,0.813 -0.814,2.133 0,2.947c0.813,0.814 2.133,0.814 2.947,0c0.813,-0.814 0.813,-2.134 0,-2.947c-0.814,-0.813 -2.134,-0.813 -2.947,0" style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M79.231,54.233c-1.274,-1.274 -3.339,-1.272 -4.611,0l-2.713,2.712c-1.274,1.275 -1.274,3.339 0,4.612l2.978,2.978c1.274,1.275 3.338,1.274 4.611,0l2.712,-2.712c1.274,-1.274 1.274,-3.339 0,-4.612l-2.977,-2.978Z" style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M95.759,41.445c-2.151,-2.578 1.869,-7.257 4.391,-4.463c4.645,5.148 -2.237,7.041 -4.391,4.463M105.004,44.132c3.442,-6.553 -1.427,-10.381 -4.773,-13.523c-5.36,-5.039 -10.706,-7.217 -16.811,-0.241c-6.102,6.977 -2.226,15.068 3.356,19.061c5.584,3.994 14.782,1.255 18.228,-5.297"
      style="fill:#000;fill-rule:nonzero;"></path>
  </svg>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1539654119"></script>
<script type="text/javascript" src="/js/auto-complete.js?1539654119"></script>
<script type="text/javascript">
    
        var baseurl = '\/';
    
</script>
<script type="text/javascript" src="/js/search.js?1539654119"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/post/" title="Posts" class="dd-item 
        
        
        
        ">
      <a href="/post/">
          Posts
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/devops/" title="DevOps" class="dd-item 
        
        
        
        ">
      <a href="/devops/">
          <b>1. </b>DevOps
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/devops/git_gerrit/" title="Git/Gerrit" class="dd-item 
        
        
        
        ">
      <a href="/devops/git_gerrit/">
          <b>1.1. </b>Git/Gerrit
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/2018-06-25-a/" title="Setup github/gerrit behind a corporate http proxy" class="dd-item ">
        <a href="/devops/git_gerrit/children/2018-06-25-a/">
        Setup github/gerrit behind a corporate http proxy
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/2018-06-23-a/" title="Setup multiple GitHub account on a single machine" class="dd-item ">
        <a href="/devops/git_gerrit/children/2018-06-23-a/">
        Setup multiple GitHub account on a single machine
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/cicd/" title="CI/CD" class="dd-item 
        
        
        
        ">
      <a href="/devops/cicd/">
          <b>1.2. </b>CI/CD
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/cicd/children/setup_submodules/" title="Setup Hugo" class="dd-item ">
        <a href="/devops/cicd/children/setup_submodules/">
        Setup Hugo
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/hugo_githubpages/" title="Hugo/GitHubPages" class="dd-item 
        
        
        
        ">
      <a href="/devops/hugo_githubpages/">
          <b>1.3. </b>Hugo/GitHubPages
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/hugo_githubpages/children/setup_hugo/" title="Setup Hugo" class="dd-item ">
        <a href="/devops/hugo_githubpages/children/setup_hugo/">
        Setup Hugo
        
        </a>
    </li>
     
  
 

            
          
             
            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/kubedgesdk/" title="Kubedge SDK" class="dd-item 
        
        
        
        ">
      <a href="/devops/kubedgesdk/">
          <b>1.4. </b>Kubedge SDK
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/kubedgesdk/children/2018-07-15-a/" title="Recompile Kubernetes components for Raspberry PI" class="dd-item ">
        <a href="/devops/kubedgesdk/children/2018-07-15-a/">
        Recompile Kubernetes components for Raspberry PI
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/kubedgesdk/children/2018-06-21-a/" title="Setup SingleNode Kubernetes Cluster using kubeadm" class="dd-item ">
        <a href="/devops/kubedgesdk/children/2018-06-21-a/">
        Setup SingleNode Kubernetes Cluster using kubeadm
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/devops/advanced/">
          <b>1.5. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/advanced/children/2018-07-16-a/" title="Rebuild Hyperkube images" class="dd-item ">
        <a href="/devops/advanced/children/2018-07-16-a/">
        Rebuild Hyperkube images
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/advanced/children/2018-06-30-a/" title="Update Kubernetes to 1.11 on Ubuntu" class="dd-item ">
        <a href="/devops/advanced/children/2018-06-30-a/">
        Update Kubernetes to 1.11 on Ubuntu
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/advanced/children/2018-06-26-a/" title="Zuul" class="dd-item ">
        <a href="/devops/advanced/children/2018-06-26-a/">
        Zuul
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pi_cluster/" title="RPI Cluster" class="dd-item 
        parent
        
        
        ">
      <a href="/pi_cluster/">
          <b>2. </b>RPI Cluster
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/os_installation/" title="Operating System" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/os_installation/">
          <b>2.1. </b>Operating System
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/2018-07-07-a/" title="Using Ansible to manage Raspberry PI cluster" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/2018-07-07-a/">
        Using Ansible to manage Raspberry PI cluster
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/2018-06-20-a/" title="Create a Rapsberry PI Rescue Dongle" class="dd-item ">
        <a href="/pi_cluster/os_installation/2018-06-20-a/">
        Create a Rapsberry PI Rescue Dongle
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/docker_kubernetes/" title="Kubernetes" class="dd-item 
        parent
        
        
        ">
      <a href="/pi_cluster/docker_kubernetes/">
          <b>2.2. </b>Kubernetes
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-14-a/" title="Deploy Flannel in Raspberry PI cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-14-a/">
        Deploy Flannel in Raspberry PI cluster
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-13-a/" title="Deploy Helm and Tiller on Rasberry PI Cluster" class="dd-item active">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-13-a/">
        Deploy Helm and Tiller on Rasberry PI Cluster
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-12-a/" title="Enable docker remote API" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-12-a/">
        Enable docker remote API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-08-a/" title="Add Persistency Volume to PI Clusters" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-08-a/">
        Add Persistency Volume to PI Clusters
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-03-a/" title="Creating a Raspberry 3 B&#43; Kubernetes Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-03-a/">
        Creating a Raspberry 3 B&#43; Kubernetes Cluster
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-06-24-a/" title="docker.io versus docker-ce" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-06-24-a/">
        docker.io versus docker-ce
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-06-19-a/" title="Add Raspberry PI node to Kubernetes Cluster in 10 min" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-06-19-a/">
        Add Raspberry PI node to Kubernetes Cluster in 10 min
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/maintenance/" title="Helm" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/maintenance/">
          <b>2.3. </b>Helm
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-09-28-a/" title="Upgrade RPI Kubernetes cluster to 1.12" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-09-28-a/">
        Upgrade RPI Kubernetes cluster to 1.12
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-07-11-a/" title="Use github repo as helm chart repository" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-07-11-a/">
        Use github repo as helm chart repository
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-07-02-a/" title="Compile and Test SONOBUOY" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-07-02-a/">
        Compile and Test SONOBUOY
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/microservices/" title="MicroServices" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/microservices/">
          <b>2.4. </b>MicroServices
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-07-30-a/" title="Build and Deploy Kubernetes test-infra" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-07-30-a/">
        Build and Deploy Kubernetes test-infra
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-07-01-a/" title="Creating simple Python server container" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-07-01-a/">
        Creating simple Python server container
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-06-29-a/" title="Creating simple GO server container" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-06-29-a/">
        Creating simple GO server container
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-06-28-a/" title="Creating simple Java 10 server container" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-06-28-a/">
        Creating simple Java 10 server container
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/microservices/children/2018-06-22-a/" title="Setup your GOLANG environment" class="dd-item ">
        <a href="/pi_cluster/microservices/children/2018-06-22-a/">
        Setup your GOLANG environment
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/advanced/">
          <b>1.5. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-08-01-a/" title="Build and Deploy Kubernetes Hashicorp Vault" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-08-01-a/">
        Build and Deploy Kubernetes Hashicorp Vault
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-31-a/" title="Build and Deploy Kubernetes Istio" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-31-a/">
        Build and Deploy Kubernetes Istio
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-29-a/" title="Build and Deploy Kubernetes Kustomize" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-29-a/">
        Build and Deploy Kubernetes Kustomize
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-18-a/" title="Compile and Test Portieris" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-18-a/">
        Compile and Test Portieris
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/lte_to_5g/" title="LTE to 5G Simulations" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/">
          <b>3. </b>LTE to 5G Simulations
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/lte_and_5g_core_simulation/" title="EPC and 5GC" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/lte_and_5g_core_simulation/">
          <b>3.1. </b>EPC and 5GC
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/lte_and_5g_ran_simulation/" title="LTE, eLTE and 5G RAN" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/lte_and_5g_ran_simulation/">
          <b>3.2. </b>LTE, eLTE and 5G RAN
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/rpi_wifi_bluetooth/" title="Spectrum" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/rpi_wifi_bluetooth/">
          <b>3.3. </b>Spectrum
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/nsa_and_sa/" title="NSA vs SA. Option 3" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/nsa_and_sa/">
          <b>3.4. </b>NSA vs SA. Option 3
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/advanced/">
          <b>3.5. </b>Advanced &amp; WIP
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/nfv/" title="NFV/SDN/Network Slicing" class="dd-item 
        
        
        
        ">
      <a href="/nfv/">
          <b>4. </b>NFV/SDN/Network Slicing
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/nfv/fd_io_and_opnfv/" title="FD.io &amp; OPNFV" class="dd-item 
        
        
        
        ">
      <a href="/nfv/fd_io_and_opnfv/">
          <b>4.1. </b>FD.io &amp; OPNFV
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/nfv/fd_io_and_opnfv/children/2018-07-17-a/" title="Rebuild Calico for AMD64 ad ARM32V7" class="dd-item ">
        <a href="/nfv/fd_io_and_opnfv/children/2018-07-17-a/">
        Rebuild Calico for AMD64 ad ARM32V7
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/onap/" title="ONAP" class="dd-item 
        
        
        
        ">
      <a href="/nfv/onap/">
          <b>4.2. </b>ONAP
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/akraino/" title="Akraino" class="dd-item 
        
        
        
        ">
      <a href="/nfv/akraino/">
          <b>4.3. </b>Akraino
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/nfv/advanced/">
          <b>4.5. </b>Advanced &amp; WIP
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/about/" title="About KUBEDGE" class="dd-item 
        
        
        
        ">
      <a href="/about/">
          About KUBEDGE
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Kubedge! Edge cluster built on Kubernetes with RPi</a> > <a href='/pi_cluster/'>RPI Cluster</a> > <a href='/pi_cluster/docker_kubernetes/'>Kubernetes</a> > Deploy Helm and Tiller on Rasberry PI Cluster
          
         
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li><a href="#goal">Goal</a>
<ul>
<li><a href="#key-aspects">Key Aspects</a></li>
<li><a href="#build-tiller-executable-and-docker-image">Build Tiller executable and Docker image</a>
<ul>
<li><a href="#cross-compiling-from-ubuntu-machine">Cross Compiling from Ubuntu Machine</a></li>
<li><a href="#cross-compiling-and-image-cration-from-travis-ci">Cross Compiling and Image cration from Travis-CI</a></li>
</ul></li>
<li><a href="#helm">Helm</a>
<ul>
<li><a href="#cross-compiling-from-ubuntu-machine-1">Cross Compiling from Ubuntu Machine</a></li>
<li><a href="#build-the-docker-image-on-the-remote-pi">Build the docker image on the remote PI</a></li>
<li><a href="#cross-compiling-and-image-cration-from-travis-ci-1">Cross Compiling and Image cration from Travis-CI</a></li>
</ul></li>
<li><a href="#install-tiller-and-helm-on-rpi">Install Tiller and Helm on RPI</a>
<ul>
<li><a href="#install-helm-on-pi">Install helm on PI</a></li>
<li><a href="#deploy-tiller-pod">Deploy Tiller POD</a></li>
<li><a href="#init-the-helm-client-side">Init the Helm client side</a></li>
</ul></li>
<li><a href="#use-helm-on-rpi">Use helm on RPI</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#reference-links">Reference Links</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Deploy Helm and Tiller on Rasberry PI Cluster</h1>
          

        




<h1 id="goal">Goal</h1>

<p>The main purpose of this exercise is to be able to use Helm on the Rapsberry PI Cluster.</p>

<h2 id="key-aspects">Key Aspects</h2>

<ul>
<li>The goal is to setup helm and tiller on the Raspberry PI cluster</li>
<li>Having the golang, glide&hellip;and related libraries setup in a PI for compilation
is kind of complicated. I started but encounter too many issues (even small), had
to install too many compilation related packages on my PI system, hence decided to
use an Ubuntu VM to compile and prepare the binaries for image for helm and tiller.
This will be usefull to setup CI/CD pipeline with Travis-CI.</li>
</ul>

<h2 id="build-tiller-executable-and-docker-image">Build Tiller executable and Docker image</h2>

<h3 id="cross-compiling-from-ubuntu-machine">Cross Compiling from Ubuntu Machine</h3>

<p>First check the go setup. Fetch the code</p>

<p>Let&rsquo;s check the go environment. See <a href="https://jbrette.github.io/jekyll/update/2018/06/22/a.html">Setup GOLANG environment</a></p>

<pre><code>which go

/usr/bin/go
</code></pre>

<pre><code>go version

go version go1.10.1 linux/amd64
</code></pre>

<pre><code>export GOPATH=$HOME/src
mkdir -p src/k8s.io
cd src/k8s.io

git clone -b release-2.9 git@github.com:kubernetes/helm.git
</code></pre>

<pre><code>cd $HOME/src/k8s.io/helm
make clean bootstrap build-cross dist APP=helm VERSION=2.9 TARGETS=linux/arm

...

go build -o bin/protoc-gen-go ./vendor/github.com/golang/protobuf/protoc-gen-go
CGO_ENABLED=0 gox -parallel=3 -output=&quot;_dist/{{.OS}}-{{.Arch}}/{{.Dir}}&quot; -osarch='linux/arm'  -tags '' -ldflags '-w -s -X k8s.io/helm/pkg/version.Version=2.9 -X k8s.io/helm/pkg/version.BuildMetadata= -X k8s.io/helm/pkg/version.GitCommit=20adb27c7c5868466912eebdf6664e7390ebe710 -X k8s.io/helm/pkg/version.GitTreeState=clean -extldflags &quot;-static&quot;' k8s.io/helm/cmd/helm
Number of parallel builds: 3

--&gt;       linux/arm: k8s.io/helm/cmd/helm
( \
        cd _dist &amp;&amp; \
        find * -type d -exec cp ../LICENSE {} \; &amp;&amp; \
        find * -type d -exec cp ../README.md {} \; &amp;&amp; \
        find * -type d -exec tar -zcf helm-2.9-{}.tar.gz {} \; &amp;&amp; \
        find * -type d -exec zip -r helm-2.9-{}.zip {} \; \
)
  adding: linux-arm/ (stored 0%)
  adding: linux-arm/LICENSE (deflated 65%)
  adding: linux-arm/README.md (deflated 59%)
  adding: linux-arm/helm (deflated 67%)
</code></pre>

<p>Let&rsquo;s transfer the helm binarie to RPI</p>

<pre><code>scp -r _dist/linux-arm/ rpiuser@192.168.1.95:/home/rpiuser/helm_binaries
</code></pre>

<h3 id="cross-compiling-and-image-cration-from-travis-ci">Cross Compiling and Image cration from Travis-CI</h3>

<ul>
<li>WIP</li>
</ul>

<h2 id="helm">Helm</h2>

<h3 id="cross-compiling-from-ubuntu-machine-1">Cross Compiling from Ubuntu Machine</h3>

<p>Let&rsquo;s assume we cloned the code for helm already.</p>

<pre><code>make clean bootstrap build-cross dist APP=tiller VERSION=2.9 TARGETS=linux/arm

...
go build -o bin/protoc-gen-go ./vendor/github.com/golang/protobuf/protoc-gen-go
CGO_ENABLED=0 gox -parallel=3 -output=&quot;_dist/{{.OS}}-{{.Arch}}/{{.Dir}}&quot; -osarch='linux/arm'  -tags '' -ldflags '-w -s -X k8s.io/helm/pkg/version.Version=2.9 -X k8s.io/helm/pkg/version.BuildMetadata= -X k8s.io/helm/pkg/version.GitCommit=20adb27c7c5868466912eebdf6664e7390ebe710 -X k8s.io/helm/pkg/version.GitTreeState=clean -extldflags &quot;-static&quot;' k8s.io/helm/cmd/tiller
Number of parallel builds: 3

--&gt;       linux/arm: k8s.io/helm/cmd/tiller
( \
        cd _dist &amp;&amp; \
        find * -type d -exec cp ../LICENSE {} \; &amp;&amp; \
        find * -type d -exec cp ../README.md {} \; &amp;&amp; \
        find * -type d -exec tar -zcf helm-2.9-{}.tar.gz {} \; &amp;&amp; \
        find * -type d -exec zip -r helm-2.9-{}.zip {} \; \
)
  adding: linux-arm/ (stored 0%)
  adding: linux-arm/LICENSE (deflated 65%)
  adding: linux-arm/README.md (deflated 59%)
  adding: linux-arm/tiller (deflated 67%)
</code></pre>

<h3 id="build-the-docker-image-on-the-remote-pi">Build the docker image on the remote PI</h3>

<p>Create a Dockerfile called rootfs/Dockerfile.arm32v7</p>

<pre><code>FROM debian:jessie-slim

RUN apt-get update \
    &amp;&amp; apt-get install -y --no-install-recommends ca-certificates \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

ENV HOME /tmp

COPY _dist/linux-arm /

EXPOSE 44134

CMD [&quot;/tiller&quot;]
</code></pre>

<pre><code>export DHUBREPO=jbrette/tiller-arm32v7
export VERSION=2.9
docker build -t $DHUBREPO:$VERSION -f rootfs/Dockerfile.arm32v7 .

Sending build context to Docker daemon  284.1MB
Step 1/6 : FROM debian:jessie-slim
 ---&gt; d273fca45b31
Step 2/6 : RUN apt-get update     &amp;&amp; apt-get install -y --no-install-recommends ca-certificates     &amp;&amp; rm -rf /var/lib/apt/lists/*
 ---&gt; Running in e51ea5c31ad7
Get:1 http://security.debian.org jessie/updates InRelease [44.9 kB]
Ign http://deb.debian.org jessie InRelease
Get:2 http://deb.debian.org jessie-updates InRelease [145 kB]
Get:3 http://deb.debian.org jessie Release.gpg [2420 B]
Get:4 http://deb.debian.org jessie Release [148 kB]
Get:5 http://security.debian.org jessie/updates/main armel Packages [576 kB]
Get:6 http://deb.debian.org jessie-updates/main armel Packages [23.7 kB]
Get:7 http://deb.debian.org jessie/main armel Packages [8902 kB]
Fetched 9843 kB in 49s (199 kB/s)
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  libssl1.0.0 openssl
The following NEW packages will be installed:
  ca-certificates libssl1.0.0 openssl
0 upgraded, 3 newly installed, 0 to remove and 1 not upgraded.
Need to get 1692 kB of archives.
After this operation, 3770 kB of additional disk space will be used.
Get:1 http://security.debian.org/debian-security/ jessie/updates/main ca-certificates all 20141019+deb8u4 [185 kB]
Get:2 http://deb.debian.org/debian/ jessie/main libssl1.0.0 armel 1.0.1t-1+deb8u8 [852 kB]
Get:3 http://deb.debian.org/debian/ jessie/main openssl armel 1.0.1t-1+deb8u8 [655 kB]
debconf: delaying package configuration, since apt-utils is not installed
Fetched 1692 kB in 7s (235 kB/s)
Selecting previously unselected package libssl1.0.0:armel.
(Reading database ... 7451 files and directories currently installed.)
Preparing to unpack .../libssl1.0.0_1.0.1t-1+deb8u8_armel.deb ...
Unpacking libssl1.0.0:armel (1.0.1t-1+deb8u8) ...
Selecting previously unselected package openssl.
Preparing to unpack .../openssl_1.0.1t-1+deb8u8_armel.deb ...
Unpacking openssl (1.0.1t-1+deb8u8) ...
Selecting previously unselected package ca-certificates.
Preparing to unpack .../ca-certificates_20141019+deb8u4_all.deb ...
Unpacking ca-certificates (20141019+deb8u4) ...
Setting up libssl1.0.0:armel (1.0.1t-1+deb8u8) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/arm-linux-gnueabi/perl/5.20.2 /usr/local/share/perl/5.20.2 /usr/lib/arm-linux-gnueabi/perl5/5.20 /usr/share/perl5 /usr/lib/arm-linux-gnueabi/perl/5.20 /usr/share/perl/5.20 /usr/local/lib/site_perl .) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7.)
debconf: falling back to frontend: Teletype
Setting up openssl (1.0.1t-1+deb8u8) ...
Setting up ca-certificates (20141019+deb8u4) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/arm-linux-gnueabi/perl/5.20.2 /usr/local/share/perl/5.20.2 /usr/lib/arm-linux-gnueabi/perl5/5.20 /usr/share/perl5 /usr/lib/arm-linux-gnueabi/perl/5.20 /usr/share/perl/5.20 /usr/local/lib/site_perl .) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7.)
debconf: falling back to frontend: Teletype
Updating certificates in /etc/ssl/certs... 152 added, 0 removed; done.
Processing triggers for libc-bin (2.19-18+deb8u10) ...
Processing triggers for ca-certificates (20141019+deb8u4) ...
Updating certificates in /etc/ssl/certs... 0 added, 0 removed; done.
Running hooks in /etc/ca-certificates/update.d....done.
Removing intermediate container e51ea5c31ad7
 ---&gt; 1dccf46769e7
Step 3/6 : ENV HOME /tmp
 ---&gt; Running in 45de8c047bd3
Removing intermediate container 45de8c047bd3
 ---&gt; baa6d8b15164
Step 4/6 : COPY _dist/linux-arm /
 ---&gt; 59a6cc8bfdbe
Step 5/6 : EXPOSE 44134
 ---&gt; Running in d2c6d9b3a3bc
Removing intermediate container d2c6d9b3a3bc
 ---&gt; 28a331217c52
Step 6/6 : CMD [&quot;/tiller&quot;]
 ---&gt; Running in 9760ea4dc6c5
Removing intermediate container 9760ea4dc6c5
 ---&gt; 9384b4f39ab3
Successfully built 9384b4f39ab3
Successfully tagged jbrette/tiller-arm32v7:2.9
</code></pre>

<h3 id="cross-compiling-and-image-cration-from-travis-ci-1">Cross Compiling and Image cration from Travis-CI</h3>

<ul>
<li>WIP</li>
</ul>

<h2 id="install-tiller-and-helm-on-rpi">Install Tiller and Helm on RPI</h2>

<h3 id="install-helm-on-pi">Install helm on PI</h3>

<pre><code>ssh rpiuser@192.168.1.95
sudo cp /home/rpiuser/helm_binaries/helm /usr/bin/helm
</code></pre>

<h3 id="deploy-tiller-pod">Deploy Tiller POD</h3>

<p>First push the tiller docker image to the repo</p>

<pre><code>docker login

docker push jbrette/tiller-arm32v7:2.9
</code></pre>

<p>Prepare the POD deployment files</p>

<pre><code>mkdir -p ~/kube-deployments/tiller
cd  ~/kube-deployments/tiller
</code></pre>

<p>Create the kubectl file for tiller service account</p>

<pre><code class="language-sh">cat tiller-serviceaccount.yaml
</code></pre>

<pre><code class="language-yaml">---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: tiller
  namespace: kube-system
...
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: tiller
    namespace: kube-system
...
</code></pre>

<p>Create the tiller service account</p>

<pre><code>kubectl create -f tiller-serviceaccount.yaml

serviceaccount/tiller created
clusterrolebinding.rbac.authorization.k8s.io/tiller created
</code></pre>

<p>Create manually the tiller deployment file and leverage the tiller service account</p>

<pre><code>helm init --service-account tiller --output yaml &gt; tiller.yaml
</code></pre>

<p>Edit the image and replace <code>gcr.io/kubernetes-helm/tiller:2.9</code> by <code>jbrette/tiller-arm32v7:2.9</code></p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  creationTimestamp: null
  labels:
    app: helm
    name: tiller
  name: tiller-deploy
  namespace: kube-system
spec:
  replicas: 1
  strategy: {}
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: helm
        name: tiller
    spec:
      containers:
      - env:
        - name: TILLER_NAMESPACE
          value: kube-system
        - name: TILLER_HISTORY_MAX
          value: &quot;0&quot;
        image: gcr.io/kubernetes-helm/tiller:2.9
        imagePullPolicy: IfNotPresent
        livenessProbe:
          httpGet:
            path: /liveness
            port: 44135
          initialDelaySeconds: 1
          timeoutSeconds: 1
        name: tiller
        ports:
        - containerPort: 44134
          name: tiller
        - containerPort: 44135
          name: http
        readinessProbe:
          httpGet:
            path: /readiness
            port: 44135
          initialDelaySeconds: 1
          timeoutSeconds: 1
        resources: {}
      serviceAccountName: tiller
status: {}
</code></pre>

<p>Deploy tiller in the kubernetes cluster</p>

<pre><code>kubectl create -f tiller.yaml
</code></pre>

<p>Check the deployment state</p>

<pre><code>kubectl get all -n kube-system

NAME                                        READY     STATUS             RESTARTS   AGE
pod/tiller-deploy-b59fcc885-66l7s           1/1       Running            0          5m

NAME                                   DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/tiller-deploy          1         1         1            1           5m

NAME                                              DESIRED   CURRENT   READY     AGE
replicaset.apps/tiller-deploy-b59fcc885           1         1         1         5m
</code></pre>

<p>Check the logs</p>

<pre><code>kubectl logs pod/tiller-deploy-b59fcc885-66l7s -n kube-system

[main] 2018/07/15 18:08:10 Starting Tiller 2.9 (tls=false)
[main] 2018/07/15 18:08:10 GRPC listening on :44134
[main] 2018/07/15 18:08:10 Probes listening on :44135
[main] 2018/07/15 18:08:10 Storage driver is ConfigMap
[main] 2018/07/15 18:08:10 Max history per release is 0
</code></pre>

<h3 id="init-the-helm-client-side">Init the Helm client side</h3>

<pre><code>helm init --client-only

Creating /home/rpiuser/.helm
Creating /home/rpiuser/.helm/repository
Creating /home/rpiuser/.helm/repository/cache
Creating /home/rpiuser/.helm/repository/local
Creating /home/rpiuser/.helm/plugins
Creating /home/rpiuser/.helm/starters
Creating /home/rpiuser/.helm/cache/archive
Creating /home/rpiuser/.helm/repository/repositories.yaml
Adding stable repo with URL: https://kubernetes-charts.storage.googleapis.com
Adding local repo with URL: http://127.0.0.1:8879/charts
$HELM_HOME has been configured at /home/rpiuser/.helm.
Not installing Tiller due to 'client-only' flag having been set
Happy Helming!
</code></pre>

<p>Check helm commands are working properly</p>

<pre><code>helm ls
helm search stable/nginx-ingress
helm inspect stable/nginx-ingress
</code></pre>

<h2 id="use-helm-on-rpi">Use helm on RPI</h2>

<p>Let&rsquo;s access the simple helm repo designed for</p>

<pre><code>helm repo add kubeplay 'https://raw.githubusercontent.com/jbrette/kubeplay/arm32v7/helmrepo/'
</code></pre>

<pre><code>helm repo list

NAME            URL
stable          https://kubernetes-charts.storage.googleapis.com
local           http://127.0.0.1:8879/charts
kubeplay        https://raw.githubusercontent.com/jbrette/kubeplay/arm32v7/helmrepo/
</code></pre>

<pre><code>helm search kubeplay

NAME                            CHART VERSION   APP VERSION     DESCRIPTION
kubeplay/kubeplay-arm32v7       0.1.0           0.1.0           A Helm chart for Kubernetes
</code></pre>

<p>Install simple hello world helm chart from kubeplay</p>

<pre><code>helm install kubeplay/kubeplay-arm32v7 --name helm-rpi

NAME:   helm-rpi
LAST DEPLOYED: Sun Jul 15 19:23:58 2018
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==&gt; v1/Service
NAME                       TYPE      CLUSTER-IP     EXTERNAL-IP  PORT(S)         AGE
helm-rpi-kubeplay-arm32v7  NodePort  10.96.168.184  &lt;none&gt;       8005:31439/TCP  2s

==&gt; v1beta1/Deployment
NAME                       DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE
helm-rpi-kubeplay-arm32v7  1        0        0           0          2s
</code></pre>

<p>Check the installation</p>

<pre><code>helm ls

NAME            REVISION        UPDATED                         STATUS          CHART                   NAMESPACE
helm-rpi        1               Sun Jul 15 19:23:58 2018        DEPLOYED        kubeplay-arm32v7-0.1.0  default
</code></pre>

<p>Check with kubectl if the POD is ready</p>

<pre><code>kubectl get all -n default

NAME                                             READY     STATUS    RESTARTS   AGE
pod/helm-rpi-kubeplay-arm32v7-58567c4756-fj968   0/1       Running   4          4m

NAME                                TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE
service/helm-rpi-kubeplay-arm32v7   NodePort    10.96.168.184   &lt;none&gt;        8005:31439/TCP   4m
service/kubernetes                  ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP          9d

NAME                                        DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/helm-rpi-kubeplay-arm32v7   1         1         1            0           4m

NAME                                                   DESIRED   CURRENT   READY     AGE
replicaset.apps/helm-rpi-kubeplay-arm32v7-58567c4756   1         1         0         4m
</code></pre>

<p>Helm chart is not really consistent. Current image hardcoded to listen on port 80
Let&rsquo;s use helm upgrade to change the value</p>

<pre><code>helm upgrade --set service.internalPort=80 helm-rpi kubeplay/kubeplay-arm32v7

Release &quot;helm-rpi&quot; has been upgraded. Happy Helming!
LAST DEPLOYED: Sun Jul 15 20:39:17 2018
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==&gt; v1beta1/Deployment
NAME                       DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE
helm-rpi-kubeplay-arm32v7  1        1        0           0          1h

==&gt; v1/Pod(related)
NAME                                        READY  STATUS       RESTARTS  AGE
helm-rpi-kubeplay-arm32v7-58567c4756-fj968  0/1    Terminating  25        1h
helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m  0/1    Pending      0         0s

==&gt; v1/Service
NAME                       TYPE      CLUSTER-IP     EXTERNAL-IP  PORT(S)         AGE
helm-rpi-kubeplay-arm32v7  NodePort  10.96.168.184  &lt;none&gt;       8005:31439/TCP  1h
</code></pre>

<p>The pod seems to now be running properly.</p>

<pre><code>kubectl get all -n default

NAME                                             READY     STATUS    RESTARTS   AGE
pod/helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m   1/1       Running   0          3m

NAME                                TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE
service/helm-rpi-kubeplay-arm32v7   NodePort    10.96.168.184   &lt;none&gt;        8005:31439/TCP   1h
service/kubernetes                  ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP          9d

NAME                                        DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/helm-rpi-kubeplay-arm32v7   1         1         1            1           1h

NAME                                                   DESIRED   CURRENT   READY     AGE
replicaset.apps/helm-rpi-kubeplay-arm32v7-58567c4756   0         0         0         1h
replicaset.apps/helm-rpi-kubeplay-arm32v7-6cb66496c6   1         1         1         3m
</code></pre>

<p>Check the POD</p>

<pre><code>$ kubectl describe pod/helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m
Name:           helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m
Namespace:      default
Node:           nas-pi/192.168.1.93
Start Time:     Sun, 15 Jul 2018 20:39:18 +0000
Labels:         app=kubeplay-arm32v7
                pod-template-hash=2762205272
                release=helm-rpi
Annotations:    &lt;none&gt;
Status:         Running
IP:             10.244.2.6
Controlled By:  ReplicaSet/helm-rpi-kubeplay-arm32v7-6cb66496c6
Containers:
  kubeplay-arm32v7:
    Container ID:   docker://737cd78bebb982c782dae2c07f4604ba71f45bc112e91aa20652e29b25bf5d63
    Image:          jbrette/kubeplay-arm32v7:0.1.0
    Image ID:       docker-pullable://jbrette/kubeplay-arm32v7@sha256:86441999035e35514fc647ff9af90bdfc152299636b48b9d3dba9107574f3957
    Port:           80/TCP
    Host Port:      0/TCP
    State:          Running
      Started:      Sun, 15 Jul 2018 20:39:23 +0000
    Ready:          True
    Restart Count:  0
    Liveness:       http-get http://:80/ delay=0s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:80/ delay=0s timeout=1s period=10s #success=1 #failure=3
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-c5v7s (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  default-token-c5v7s:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-c5v7s
    Optional:    false
QoS Class:       BestEffort
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute for 300s
                 node.kubernetes.io/unreachable:NoExecute for 300s
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  10m   default-scheduler  Successfully assigned default/helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m to nas-pi
  Normal  Pulling    10m   kubelet, nas-pi    pulling image &quot;jbrette/kubeplay-arm32v7:0.1.0&quot;
  Normal  Pulled     10m   kubelet, nas-pi    Successfully pulled image &quot;jbrette/kubeplay-arm32v7:0.1.0&quot;
  Normal  Created    10m   kubelet, nas-pi    Created container
  Normal  Started    10m   kubelet, nas-pi    Started container
</code></pre>

<p>Let&rsquo;s open a browser towards the URL:</p>

<p><img src="/images/kubeplay/kubeplay_arm32v7.png" alt="" />
<img src="/images/kubeplay/dashboard.png" alt="" /></p>

<h2 id="conclusion">Conclusion</h2>

<ul>
<li>Need to cleanup the helm chart and docker image to ensure consistency of the internal</li>
<li>Need to improve the NodePort/ClusterIP/LoadBalancer handling.</li>
</ul>

<h2 id="reference-links">Reference Links</h2>

<ul>
<li><a href="https://github.com/jonaseck2/rpi-helm">Usage of remote API</a></li>
</ul>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/pi_cluster/docker_kubernetes/children/2018-07-14-a/" title="Deploy Flannel in Raspberry PI cluster"> <i class="fas fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/pi_cluster/docker_kubernetes/children/2018-07-12-a/" title="Enable docker remote API" style="margin-right: 0px;"><i class="fas fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1539654119"></script>
    <script src="/js/perfect-scrollbar.min.js?1539654119"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1539654119"></script>
    <script src="/js/jquery.sticky.js?1539654119"></script>
    <script src="/js/featherlight.min.js?1539654119"></script>
    <script src="/js/html5shiv-printshiv.min.js?1539654119"></script>
    <script src="/js/highlight.pack.js?1539654119"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1539654119"></script>
    <script src="/js/learn.js?1539654119"></script>
    <script src="/js/hugo-learn.js?1539654119"></script>

    <link href="/mermaid/mermaid.css?1539654119" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1539654119"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

