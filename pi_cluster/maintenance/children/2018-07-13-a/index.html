<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.49" />
    <meta name="description" content="KUBEDGE">
<meta name="author" content="Kubedge Team">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />
    <title>Deply Helm and Tiller on PI Cluster :: KUBEDGE&#39;s Blog</title>

    
    <link href="/css/nucleus.css?1540758761" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1540758761" rel="stylesheet">
    <link href="/css/hybrid.css?1540758761" rel="stylesheet">
    <link href="/css/featherlight.min.css?1540758761" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1540758761" rel="stylesheet">
    <link href="/css/auto-complete.css?1540758761" rel="stylesheet">
    <link href="/css/theme.css?1540758761" rel="stylesheet">
    <link href="/css/hugo-theme.css?1540758761" rel="stylesheet">
    
      <link href="/css/theme-kubedge.css?1540758761" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1540758761"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/pi_cluster/maintenance/children/2018-07-13-a/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="">
<svg id="grav-logo" width="100%" height="100%" viewBox="110 125 225 125" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" >
<style type="text/css">
	.st0{fill:#1B75BC;stroke:#1B75BC;stroke-width:4;stroke-miterlimit:10;}
	.st1{fill:#FFFFFF;stroke:#1B75BC;stroke-width:0.25;stroke-miterlimit:10;}
</style>
<g>
	<path class="st1" d="M120.78,221.22c0,1.66-0.04,1.93,1.5,2.42c0.57,0.18,0.97,0.58,0.97,1.21c0,1.3-1.46,1.39-1.63,1.39h-12.5
		c-0.18,0-1.63-0.09-1.63-1.39c0-0.63,0.4-1.03,0.97-1.21c1.55-0.49,1.5-0.76,1.5-2.42V197.7c0-1.66,0.04-1.93-1.5-2.42
		c-0.57-0.18-0.97-0.58-0.97-1.21c0-1.3,1.46-1.39,1.63-1.39h12.5c0.18,0,1.63,0.09,1.63,1.39c0,0.63-0.4,1.03-0.97,1.21
		c-1.55,0.49-1.5,0.76-1.5,2.42V221.22z M137.44,221.36c0.4,0.99,0.53,1.75,1.55,2.24c0.66,0.31,1.06,0.58,1.06,1.44
		c0,1.3-1.46,1.21-2.34,1.21h-11.09c-1.02,0-2.34,0-2.34-1.39c0-1.48,1.81-1.21,1.81-2.2c0-0.36-0.22-1.03-0.35-1.35l-2.74-8.35
		c-0.27-0.85-0.57-1.8-0.57-2.74s0.49-1.53,1.02-2.29l5.13-7.41c0.62-0.85,1.15-1.75,1.15-2.83c0-1.21-0.62-1.84-1.68-2.29
		c-0.71-0.31-1.37-0.49-1.37-1.39c0-1.39,1.24-1.35,2.16-1.35h7.55c1.06,0,2.34,0.04,2.34,1.48c0,1.03-0.84,1.35-1.63,1.66
		c-3.05,1.17-4.06,2.87-5.92,5.43l-0.84,1.17L137.44,221.36z"/>
	<path class="st1" d="M159.53,226.92c-3.49,0-6.19-0.05-9.23-1.75c-3.98-2.24-4.51-3.95-4.51-6.2V197.7c0-1.66,0.04-1.93-1.5-2.42
		c-0.57-0.18-0.97-0.58-0.97-1.21c0-1.3,1.46-1.39,1.63-1.39h12.5c0.18,0,1.63,0.09,1.63,1.39c0,0.63-0.4,1.03-0.97,1.21
		c-1.55,0.49-1.5,0.76-1.5,2.42v21.59c0,0.45-0.4,4,2.92,4.98V226.92z M167.44,199.76c-0.71-5.61-3.53-3.86-3.53-5.79
		c0-1.39,1.81-1.3,2.3-1.3h5.04c0.49,0,2.3-0.09,2.3,1.3c0,1.93-2.83,0.18-3.53,5.79v16.93c-0.35,7.41-5.61,10.1-8.48,10.15v-2.65
		c4.06-1.26,5.66-3.59,5.92-7.59V199.76z"/>
	<path class="st1" d="M189.7,226.25h-11.88c-0.31,0-1.41-0.09-1.41-1.39c0-0.63,0.4-1.03,0.97-1.21c1.55-0.49,1.5-0.76,1.5-2.42
		V197.7c0-1.66,0.04-1.93-1.5-2.42c-0.57-0.18-0.97-0.58-0.97-1.21c0-1.3,1.1-1.39,1.41-1.39h11.88V226.25z M191.69,192.67h1.37
		c2.78,0,5.61,0.04,8.17,1.3c2.74,1.39,4.33,3.73,4.33,6.91c0,4.94-4.06,7.23-8.35,7.9v0.09c4.9,0.81,8.79,3.01,8.79,8.62
		c0,3.19-1.37,5.7-4.15,7.27c-2.83,1.62-5.61,1.48-8.75,1.48h-1.41v-2.6c2.96-0.14,3.31-1.84,3.31-3.46v-5.79
		c0-2.07-0.49-4-3.31-4.22v-2.6c3.23-0.27,3.31-2.2,3.31-3.86v-4.49c0-1.89-0.66-3.68-3.31-3.95V192.67z"/>
	<path class="st1" d="M211.4,192.67h11.66v33.58H211.4c-0.18,0-1.63-0.09-1.63-1.39c0-0.63,0.4-1.03,0.97-1.21
		c1.55-0.49,1.5-0.76,1.5-2.42V197.7c0-1.66,0.04-1.93-1.5-2.42c-0.57-0.18-0.97-0.58-0.97-1.21
		C209.76,192.76,211.22,192.67,211.4,192.67z M225.05,192.67h9.85v9.11c0,0.22-0.04,1.08-1.37,1.08c-0.75,0-0.97-0.45-1.19-1.12
		c-1.15-3.64-3.4-5.84-7.29-6.46V192.67z M225.05,207.66c1.86-0.49,2.69-2.24,3.09-3.95c0.22-0.76,0.49-1.48,1.41-1.48
		c1.37,0,1.15,1.62,1.15,1.98v9.7c0,0.36,0.22,1.98-1.15,1.98c-0.93,0-1.19-0.72-1.41-1.48c-0.4-1.71-1.24-3.46-3.09-3.95V207.66z
		 M225.05,223.65c3.58-0.45,6.32-2.92,7.51-6.51c0.31-0.67,0.57-1.39,1.37-1.39c1.41,0,1.28,1.35,1.28,1.53v8.98h-10.16V223.65z"/>
	<path class="st1" d="M251.65,226.25h-11.22c-0.97,0-2.08-0.09-2.08-1.39c0-0.63,0.4-1.03,0.97-1.21c1.55-0.49,1.5-0.76,1.5-2.42
		V197.7c0-0.67,0.09-1.89-0.75-2.15c-0.88-0.31-1.72-0.45-1.72-1.57c0-1.17,1.1-1.3,1.99-1.3h11.31V226.25z M253.63,192.67
		c7.51-0.09,13.78,5.21,14.31,16.79c0.49,10.55-6.98,16.79-14.31,16.79v-2.6c2.69-0.36,2.83-2.92,2.83-4.62V199.9
		c0-1.71-0.13-4.26-2.83-4.62V192.67z"/>
	<path class="st1" d="M281.78,220.19c0,1.62,0.35,3.5,2.12,4.13v2.6c-7.69-0.23-13.61-7.86-13.61-17.46
		c0-9.65,5.92-17.28,13.61-17.46v2.6c-1.77,0.63-2.12,2.47-2.12,4.08V220.19z M285.89,224.32c1.94-0.58,2.03-2.11,2.03-2.87v-8.08
		c0-0.99-0.04-1.21-1.81-1.53c-0.71-0.18-1.15-0.58-1.15-1.35c0-1.21,1.55-1.26,1.77-1.26h10.56c0.22,0,1.55-0.13,1.55,1.35
		c0,0.76-0.4,1.08-0.8,1.35c-0.93,0.58-0.79,1.12-0.79,1.35v8.89c-3.09,2.83-7.16,4.67-11.35,4.76V224.32z M285.89,192
		c4.64,0.4,7.02,1.66,7.51,1.66c1.33,0,1.19-1.66,2.61-1.66c1.33,0,1.24,1.21,1.24,1.44v10.01c0,0.22,0,1.62-1.37,1.62
		c-1.15,0-1.46-0.85-1.68-1.8c-1.37-5.75-4.73-8.49-8.31-8.66V192z"/>
	<path class="st1" d="M303.29,192.67h11.66v33.58h-11.66c-0.18,0-1.63-0.09-1.63-1.39c0-0.63,0.4-1.03,0.97-1.21
		c1.55-0.49,1.5-0.76,1.5-2.42V197.7c0-1.66,0.04-1.93-1.5-2.42c-0.57-0.18-0.97-0.58-0.97-1.21
		C301.66,192.76,303.12,192.67,303.29,192.67z M316.95,192.67h9.85v9.11c0,0.22-0.04,1.08-1.37,1.08c-0.75,0-0.97-0.45-1.19-1.12
		c-1.15-3.64-3.4-5.84-7.29-6.46V192.67z M316.95,207.66c1.86-0.49,2.69-2.24,3.09-3.95c0.22-0.76,0.49-1.48,1.41-1.48
		c1.37,0,1.15,1.62,1.15,1.98v9.7c0,0.36,0.22,1.98-1.15,1.98c-0.93,0-1.19-0.72-1.41-1.48c-0.4-1.71-1.24-3.46-3.09-3.95V207.66z
		 M316.95,223.65c3.58-0.45,6.32-2.92,7.51-6.51c0.31-0.67,0.57-1.39,1.37-1.39c1.41,0,1.28,1.35,1.28,1.53v8.98h-10.16V223.65z"/>
</g>
</svg>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1540758761"></script>
<script type="text/javascript" src="/js/auto-complete.js?1540758761"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="/js/search.js?1540758761"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/post/" title="Latest News" class="dd-item 
        
        
        
        ">
      <a href="/post/">
          Latest News
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/devops/" title="DevOps" class="dd-item 
        
        
        
        ">
      <a href="/devops/">
          <b>1. </b>DevOps
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/devops/git_gerrit/" title="Git/Gerrit" class="dd-item 
        
        
        
        ">
      <a href="/devops/git_gerrit/">
          <b>1.1. </b>Git &amp; Gerrit
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/setup_git/" title="Setting up GitHub" class="dd-item ">
        <a href="/devops/git_gerrit/children/setup_git/">
        GitHub
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/setup_gerrit/" title="Setting up GerritHub" class="dd-item ">
        <a href="/devops/git_gerrit/children/setup_gerrit/">
        GerritHub
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/2018-06-25-a/" title="Setup github/gerrit behind a corporate http proxy" class="dd-item ">
        <a href="/devops/git_gerrit/children/2018-06-25-a/">
        Corporate Proxy
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/git_gerrit/children/2018-06-23-a/" title="Setup multiple GitHub account on a single machine" class="dd-item ">
        <a href="/devops/git_gerrit/children/2018-06-23-a/">
        Multiple GitHub accounts
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/cicd/" title="CI/CD" class="dd-item 
        
        
        
        ">
      <a href="/devops/cicd/">
          <b>1.2. </b>CI/CD
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/cicd/children/setup_dockerhub/" title="Setting up DockerHub" class="dd-item ">
        <a href="/devops/cicd/children/setup_dockerhub/">
        DockerHub
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/cicd/children/setup_travis-ci/" title="Setting up Travis-CI" class="dd-item ">
        <a href="/devops/cicd/children/setup_travis-ci/">
        Travis-CI
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/hugo_githubpages/" title="Hugo/GitHubPages" class="dd-item 
        
        
        
        ">
      <a href="/devops/hugo_githubpages/">
          <b>1.3. </b>Hugo &amp; GitHub pages
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/kubedgesdk/" title="Kubedge SDK" class="dd-item 
        
        
        
        ">
      <a href="/devops/kubedgesdk/">
          <b>1.4. </b>Kubedge SDK
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/kubedgesdk/children/2018-07-15-a/" title="Recompile Kubernetes components for Raspberry PI" class="dd-item ">
        <a href="/devops/kubedgesdk/children/2018-07-15-a/">
        Kubernetes cross-compilation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/kubedgesdk/children/2018-06-24-a/" title="docker.io versus docker-ce" class="dd-item ">
        <a href="/devops/kubedgesdk/children/2018-06-24-a/">
        Docker
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/kubedgesdk/children/2018-06-21-a/" title="Setup SingleNode Kubernetes Cluster using kubeadm" class="dd-item ">
        <a href="/devops/kubedgesdk/children/2018-06-21-a/">
        SingleNode Kubernetes
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/microservices/" title="MicroServices" class="dd-item 
        
        
        
        ">
      <a href="/devops/microservices/">
          <b>1.5. </b>MicroServices
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/microservices/children/2018-07-01-a/" title="Python" class="dd-item ">
        <a href="/devops/microservices/children/2018-07-01-a/">
        Python
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/microservices/children/2018-06-29-a/" title="Creating simple GO server container" class="dd-item ">
        <a href="/devops/microservices/children/2018-06-29-a/">
        GO
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/microservices/children/2018-06-28-a/" title="Creating simple Java 10 server container" class="dd-item ">
        <a href="/devops/microservices/children/2018-06-28-a/">
        Java 10
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/microservices/children/2018-06-22-a/" title="Setup your GOLANG environment" class="dd-item ">
        <a href="/devops/microservices/children/2018-06-22-a/">
        GOLANG env
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/devops/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/devops/advanced/">
          <b>1.6. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/devops/advanced/children/2018-07-16-a/" title="Rebuild Hyperkube images" class="dd-item ">
        <a href="/devops/advanced/children/2018-07-16-a/">
        Hyperkube images
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/devops/advanced/children/2018-06-26-a/" title="Zuul" class="dd-item ">
        <a href="/devops/advanced/children/2018-06-26-a/">
        Zuul
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pi_cluster/" title="RPI Cluster" class="dd-item 
        parent
        
        
        ">
      <a href="/pi_cluster/">
          <b>2. </b>RPI Cluster
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/os_installation/" title="Operating System" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/os_installation/">
          <b>2.1. </b>Operating System
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/cluster_assembly/" title="Raspberry PI cluster Assembly" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/cluster_assembly/">
        HW Assembly
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/master_pi/" title="OS Installation on Master PI" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/master_pi/">
        OS on Master PI
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/setup_wpa_applicant/" title="Setting up WPA supplicant on Master PI" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/setup_wpa_applicant/">
        WPA supplicant
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/setup_dhcpd/" title="Setting up DHCPD on master PI" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/setup_dhcpd/">
        DHCPD &amp; NAT
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/worker_pi/" title="OS Installation on Worker PI" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/worker_pi/">
        OS on Worker PI
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/ansible/" title="Using Ansible to manage Raspberry PI cluster" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/ansible/">
        Ansible
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/os_installation/children/dongle/" title="Create a Rapsberry PI Rescue Dongle" class="dd-item ">
        <a href="/pi_cluster/os_installation/children/dongle/">
        Rescue Dongle
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/docker_kubernetes/" title="Kubernetes" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/docker_kubernetes/">
          <b>2.2. </b>Kubernetes
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-03-a/" title="Creating a Raspberry 3 B&#43; Kubernetes Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-03-a/">
        Installation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-08-a/" title="Add Persistency Volume to PI Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-08-a/">
        Persistency Volume
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-14-a/" title="Deploy Flannel in PI Cluster" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-14-a/">
        Flannel
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-06-19-a/" title="Add Raspberry PI node to Kubernetes Cluster in 10 min" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-06-19-a/">
        Add a node
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/docker_kubernetes/children/2018-07-12-a/" title="Enable docker Remote API" class="dd-item ">
        <a href="/pi_cluster/docker_kubernetes/children/2018-07-12-a/">
        Docker Remote API
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/maintenance/" title="Helm &amp; Maintenance" class="dd-item 
        parent
        
        
        ">
      <a href="/pi_cluster/maintenance/">
          <b>2.3. </b>Helm &amp; Maintenance
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-07-13-a/" title="Deply Helm and Tiller on PI Cluster" class="dd-item active">
        <a href="/pi_cluster/maintenance/children/2018-07-13-a/">
        Helm and Tiller
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-07-11-a/" title="Use github repo as helm chart repository" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-07-11-a/">
        Helm charts repo
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-09-28-a/" title="Upgrade RPI Kubernetes cluster to 1.12" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-09-28-a/">
        Upgrade to K8s 1.12
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/maintenance/children/2018-07-02-a/" title="Compile and Test SONOBUOY" class="dd-item ">
        <a href="/pi_cluster/maintenance/children/2018-07-02-a/">
        Sonobuoy
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/applications/" title="Applications" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/applications/">
          <b>2.4. </b>Applications
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/applications/children/kubernetes_dashboard/" title="Installing Kubernetes Dashboard" class="dd-item ">
        <a href="/pi_cluster/applications/children/kubernetes_dashboard/">
        Dashboard
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/applications/children/grafana/" title="Installing Grafana" class="dd-item ">
        <a href="/pi_cluster/applications/children/grafana/">
        Grafana
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/applications/children/kubesim_kubeplay/" title="Installing Kubedge Kubeplay" class="dd-item ">
        <a href="/pi_cluster/applications/children/kubesim_kubeplay/">
        Kubeplay
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/applications/children/kubesim_blinkt/" title="Installing Kubedge Blinkt" class="dd-item ">
        <a href="/pi_cluster/applications/children/kubesim_blinkt/">
        Blinkt
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pi_cluster/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/pi_cluster/advanced/">
          <b>2.5. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-06-30-a/" title="Update Kubernetes to 1.11 on Ubuntu" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-06-30-a/">
        Upgrade to K8s 1.11
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-30-a/" title="Build and Deploy Kubernetes test-infra" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-30-a/">
        Test-Infra
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-08-01-a/" title="Build and Deploy Kubernetes Hashicorp Vault" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-08-01-a/">
        Hashicorp Vault
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-31-a/" title="Build and Deploy Kubernetes Istio" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-31-a/">
        Istio
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-29-a/" title="Build and Deploy Kubernetes Kustomize" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-29-a/">
        Kustomize
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pi_cluster/advanced/children/2018-07-18-a/" title="Compile and Test Portieris" class="dd-item ">
        <a href="/pi_cluster/advanced/children/2018-07-18-a/">
        Portieris
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/lte_to_5g/" title="LTE to 5G Simulations" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/">
          <b>3. </b>LTE to 5G Simulations
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/rpi_wifi_ap/" title="WIFI AP" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/rpi_wifi_ap/">
          <b>3.1. </b>WIFI AP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/lte_to_5g/rpi_wifi_ap/children/setup_hostapd/" title="Setting up HOSTAPD on 5G NR node" class="dd-item ">
        <a href="/lte_to_5g/rpi_wifi_ap/children/setup_hostapd/">
        HOSTAPD
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/lte_to_5g/rpi_wifi_ap/children/setup_dhcpd/" title="Setting up DHCPD on 5G NR Node" class="dd-item ">
        <a href="/lte_to_5g/rpi_wifi_ap/children/setup_dhcpd/">
        DHCPD &amp; NAT
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/rpi_bluetooth_pan/" title="Bluetooth PAN" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/rpi_bluetooth_pan/">
          <b>3.2. </b>Bluetooth PAN
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/lte_to_5g/rpi_bluetooth_pan/children/setup_pan/" title="Setting up PAN" class="dd-item ">
        <a href="/lte_to_5g/rpi_bluetooth_pan/children/setup_pan/">
        PAN
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/lte_to_5g/rpi_bluetooth_pan/children/setup_dhcpd/" title="Setting up DHCPD on LTE &amp; eLTE Node" class="dd-item ">
        <a href="/lte_to_5g/rpi_bluetooth_pan/children/setup_dhcpd/">
        DHCPD &amp; NAT
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/lte_and_5g_core_simulation/" title="EPC and 5GC" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/lte_and_5g_core_simulation/">
          <b>3.3. </b>EPC and 5GC
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/lte_and_5g_ran_simulation/" title="LTE, eLTE and 5G RAN" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/lte_and_5g_ran_simulation/">
          <b>3.4. </b>LTE, eLTE and 5G RAN
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/nsa_and_sa/" title="NSA vs SA. Option 3" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/nsa_and_sa/">
          <b>3.5. </b>NSA vs SA. Option 3
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/lte_to_5g/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/lte_to_5g/advanced/">
          <b>3.6. </b>Advanced &amp; WIP
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/nfv/" title="NFV/SDN/Network Slicing" class="dd-item 
        
        
        
        ">
      <a href="/nfv/">
          <b>4. </b>NFV/SDN/Network Slicing
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/nfv/fd_io_and_opnfv/" title="FD.io &amp; OPNFV" class="dd-item 
        
        
        
        ">
      <a href="/nfv/fd_io_and_opnfv/">
          <b>4.1. </b>FD.io &amp; OPNFV
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/onap/" title="ONAP" class="dd-item 
        
        
        
        ">
      <a href="/nfv/onap/">
          <b>4.2. </b>ONAP
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/akraino/" title="Akraino" class="dd-item 
        
        
        
        ">
      <a href="/nfv/akraino/">
          <b>4.3. </b>Akraino
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/nfv/advanced/" title="Advanced &amp; WIP" class="dd-item 
        
        
        
        ">
      <a href="/nfv/advanced/">
          <b>4.5. </b>Advanced &amp; WIP
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/nfv/advanced/children/2018-07-17-a/" title="Rebuild Calico for AMD64 ad ARM32V7" class="dd-item ">
        <a href="/nfv/advanced/children/2018-07-17-a/">
        Calico
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/about/" title="About KUBEDGE" class="dd-item 
        
        
        
        ">
      <a href="/about/">
          About KUBEDGE
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/kubedge/blog/tree/master/contentpi_cluster/maintenance/children/2018-07-13-a.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Kubedge</a> > <a href='/pi_cluster/'>RPI Cluster</a> > <a href='/pi_cluster/maintenance/'>Helm & Maintenance</a> > Deply Helm and Tiller on PI Cluster
          
         
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#key-aspects">Key Aspects</a></li>
<li><a href="#build-tiller-executable-and-docker-image">Build Tiller executable and Docker image</a>
<ul>
<li><a href="#cross-compiling-from-ubuntu-machine">Cross Compiling from Ubuntu Machine</a></li>
<li><a href="#cross-compiling-and-image-cration-from-travis-ci">Cross Compiling and Image cration from Travis-CI</a></li>
</ul></li>
<li><a href="#helm">Helm</a>
<ul>
<li><a href="#cross-compiling-from-ubuntu-machine-1">Cross Compiling from Ubuntu Machine</a></li>
<li><a href="#build-the-docker-image-on-the-remote-pi">Build the docker image on the remote PI</a></li>
<li><a href="#cross-compiling-and-image-cration-from-travis-ci-1">Cross Compiling and Image cration from Travis-CI</a></li>
</ul></li>
<li><a href="#install-tiller-and-helm-on-rpi">Install Tiller and Helm on RPI</a>
<ul>
<li><a href="#install-helm-on-pi">Install helm on PI</a></li>
<li><a href="#deploy-tiller-pod">Deploy Tiller POD</a></li>
<li><a href="#init-the-helm-client-side">Init the Helm client side</a></li>
</ul></li>
<li><a href="#use-helm-on-rpi">Use helm on RPI</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#reference-links">Reference Links</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Deply Helm and Tiller on PI Cluster</h1>
          

        


<p>The main purpose of this exercise is to be able to use Helm on the Rapsberry PI Cluster.</p>

<p></p>

<h2 id="key-aspects">Key Aspects</h2>

<ul>
<li>The goal is to setup helm and tiller on the Raspberry PI cluster</li>
<li>Having the golang, glide&hellip;and related libraries setup in a PI for compilation
is kind of complicated. I started but encounter too many issues (even small), had
to install too many compilation related packages on my PI system, hence decided to
use an Ubuntu VM to compile and prepare the binaries for image for helm and tiller.
This will be usefull to setup CI/CD pipeline with Travis-CI.</li>
</ul>

<h2 id="build-tiller-executable-and-docker-image">Build Tiller executable and Docker image</h2>

<h3 id="cross-compiling-from-ubuntu-machine">Cross Compiling from Ubuntu Machine</h3>

<p>First check the go setup. Fetch the code</p>

<p>Let&rsquo;s check the go environment. See <a href="https://jbrette.github.io/jekyll/update/2018/06/22/a.html">Setup GOLANG environment</a></p>

<pre><code>which go

/usr/bin/go
</code></pre>

<pre><code>go version

go version go1.10.1 linux/amd64
</code></pre>

<pre><code>export GOPATH=$HOME/src
mkdir -p src/k8s.io
cd src/k8s.io

git clone -b release-2.9 git@github.com:kubernetes/helm.git
</code></pre>

<pre><code>cd $HOME/src/k8s.io/helm
make clean bootstrap build-cross dist APP=helm VERSION=2.9 TARGETS=linux/arm

...

go build -o bin/protoc-gen-go ./vendor/github.com/golang/protobuf/protoc-gen-go
CGO_ENABLED=0 gox -parallel=3 -output=&quot;_dist/{{.OS}}-{{.Arch}}/{{.Dir}}&quot; -osarch='linux/arm'  -tags '' -ldflags '-w -s -X k8s.io/helm/pkg/version.Version=2.9 -X k8s.io/helm/pkg/version.BuildMetadata= -X k8s.io/helm/pkg/version.GitCommit=20adb27c7c5868466912eebdf6664e7390ebe710 -X k8s.io/helm/pkg/version.GitTreeState=clean -extldflags &quot;-static&quot;' k8s.io/helm/cmd/helm
Number of parallel builds: 3

--&gt;       linux/arm: k8s.io/helm/cmd/helm
( \
        cd _dist &amp;&amp; \
        find * -type d -exec cp ../LICENSE {} \; &amp;&amp; \
        find * -type d -exec cp ../README.md {} \; &amp;&amp; \
        find * -type d -exec tar -zcf helm-2.9-{}.tar.gz {} \; &amp;&amp; \
        find * -type d -exec zip -r helm-2.9-{}.zip {} \; \
)
  adding: linux-arm/ (stored 0%)
  adding: linux-arm/LICENSE (deflated 65%)
  adding: linux-arm/README.md (deflated 59%)
  adding: linux-arm/helm (deflated 67%)
</code></pre>

<p>Let&rsquo;s transfer the helm binarie to RPI</p>

<pre><code>scp -r _dist/linux-arm/ rpiuser@192.168.1.95:/home/rpiuser/helm_binaries
</code></pre>

<h3 id="cross-compiling-and-image-cration-from-travis-ci">Cross Compiling and Image cration from Travis-CI</h3>

<ul>
<li>WIP</li>
</ul>

<h2 id="helm">Helm</h2>

<h3 id="cross-compiling-from-ubuntu-machine-1">Cross Compiling from Ubuntu Machine</h3>

<p>Let&rsquo;s assume we cloned the code for helm already.</p>

<pre><code>make clean bootstrap build-cross dist APP=tiller VERSION=2.9 TARGETS=linux/arm

...
go build -o bin/protoc-gen-go ./vendor/github.com/golang/protobuf/protoc-gen-go
CGO_ENABLED=0 gox -parallel=3 -output=&quot;_dist/{{.OS}}-{{.Arch}}/{{.Dir}}&quot; -osarch='linux/arm'  -tags '' -ldflags '-w -s -X k8s.io/helm/pkg/version.Version=2.9 -X k8s.io/helm/pkg/version.BuildMetadata= -X k8s.io/helm/pkg/version.GitCommit=20adb27c7c5868466912eebdf6664e7390ebe710 -X k8s.io/helm/pkg/version.GitTreeState=clean -extldflags &quot;-static&quot;' k8s.io/helm/cmd/tiller
Number of parallel builds: 3

--&gt;       linux/arm: k8s.io/helm/cmd/tiller
( \
        cd _dist &amp;&amp; \
        find * -type d -exec cp ../LICENSE {} \; &amp;&amp; \
        find * -type d -exec cp ../README.md {} \; &amp;&amp; \
        find * -type d -exec tar -zcf helm-2.9-{}.tar.gz {} \; &amp;&amp; \
        find * -type d -exec zip -r helm-2.9-{}.zip {} \; \
)
  adding: linux-arm/ (stored 0%)
  adding: linux-arm/LICENSE (deflated 65%)
  adding: linux-arm/README.md (deflated 59%)
  adding: linux-arm/tiller (deflated 67%)
</code></pre>

<h3 id="build-the-docker-image-on-the-remote-pi">Build the docker image on the remote PI</h3>

<p>Create a Dockerfile called rootfs/Dockerfile.arm32v7</p>

<pre><code>FROM debian:jessie-slim

RUN apt-get update \
    &amp;&amp; apt-get install -y --no-install-recommends ca-certificates \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

ENV HOME /tmp

COPY _dist/linux-arm /

EXPOSE 44134

CMD [&quot;/tiller&quot;]
</code></pre>

<pre><code>export DHUBREPO=jbrette/tiller-arm32v7
export VERSION=2.9
docker build -t $DHUBREPO:$VERSION -f rootfs/Dockerfile.arm32v7 .

Sending build context to Docker daemon  284.1MB
Step 1/6 : FROM debian:jessie-slim
 ---&gt; d273fca45b31
Step 2/6 : RUN apt-get update     &amp;&amp; apt-get install -y --no-install-recommends ca-certificates     &amp;&amp; rm -rf /var/lib/apt/lists/*
 ---&gt; Running in e51ea5c31ad7
Get:1 http://security.debian.org jessie/updates InRelease [44.9 kB]
Ign http://deb.debian.org jessie InRelease
Get:2 http://deb.debian.org jessie-updates InRelease [145 kB]
Get:3 http://deb.debian.org jessie Release.gpg [2420 B]
Get:4 http://deb.debian.org jessie Release [148 kB]
Get:5 http://security.debian.org jessie/updates/main armel Packages [576 kB]
Get:6 http://deb.debian.org jessie-updates/main armel Packages [23.7 kB]
Get:7 http://deb.debian.org jessie/main armel Packages [8902 kB]
Fetched 9843 kB in 49s (199 kB/s)
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  libssl1.0.0 openssl
The following NEW packages will be installed:
  ca-certificates libssl1.0.0 openssl
0 upgraded, 3 newly installed, 0 to remove and 1 not upgraded.
Need to get 1692 kB of archives.
After this operation, 3770 kB of additional disk space will be used.
Get:1 http://security.debian.org/debian-security/ jessie/updates/main ca-certificates all 20141019+deb8u4 [185 kB]
Get:2 http://deb.debian.org/debian/ jessie/main libssl1.0.0 armel 1.0.1t-1+deb8u8 [852 kB]
Get:3 http://deb.debian.org/debian/ jessie/main openssl armel 1.0.1t-1+deb8u8 [655 kB]
debconf: delaying package configuration, since apt-utils is not installed
Fetched 1692 kB in 7s (235 kB/s)
Selecting previously unselected package libssl1.0.0:armel.
(Reading database ... 7451 files and directories currently installed.)
Preparing to unpack .../libssl1.0.0_1.0.1t-1+deb8u8_armel.deb ...
Unpacking libssl1.0.0:armel (1.0.1t-1+deb8u8) ...
Selecting previously unselected package openssl.
Preparing to unpack .../openssl_1.0.1t-1+deb8u8_armel.deb ...
Unpacking openssl (1.0.1t-1+deb8u8) ...
Selecting previously unselected package ca-certificates.
Preparing to unpack .../ca-certificates_20141019+deb8u4_all.deb ...
Unpacking ca-certificates (20141019+deb8u4) ...
Setting up libssl1.0.0:armel (1.0.1t-1+deb8u8) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/arm-linux-gnueabi/perl/5.20.2 /usr/local/share/perl/5.20.2 /usr/lib/arm-linux-gnueabi/perl5/5.20 /usr/share/perl5 /usr/lib/arm-linux-gnueabi/perl/5.20 /usr/share/perl/5.20 /usr/local/lib/site_perl .) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7.)
debconf: falling back to frontend: Teletype
Setting up openssl (1.0.1t-1+deb8u8) ...
Setting up ca-certificates (20141019+deb8u4) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/arm-linux-gnueabi/perl/5.20.2 /usr/local/share/perl/5.20.2 /usr/lib/arm-linux-gnueabi/perl5/5.20 /usr/share/perl5 /usr/lib/arm-linux-gnueabi/perl/5.20 /usr/share/perl/5.20 /usr/local/lib/site_perl .) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7.)
debconf: falling back to frontend: Teletype
Updating certificates in /etc/ssl/certs... 152 added, 0 removed; done.
Processing triggers for libc-bin (2.19-18+deb8u10) ...
Processing triggers for ca-certificates (20141019+deb8u4) ...
Updating certificates in /etc/ssl/certs... 0 added, 0 removed; done.
Running hooks in /etc/ca-certificates/update.d....done.
Removing intermediate container e51ea5c31ad7
 ---&gt; 1dccf46769e7
Step 3/6 : ENV HOME /tmp
 ---&gt; Running in 45de8c047bd3
Removing intermediate container 45de8c047bd3
 ---&gt; baa6d8b15164
Step 4/6 : COPY _dist/linux-arm /
 ---&gt; 59a6cc8bfdbe
Step 5/6 : EXPOSE 44134
 ---&gt; Running in d2c6d9b3a3bc
Removing intermediate container d2c6d9b3a3bc
 ---&gt; 28a331217c52
Step 6/6 : CMD [&quot;/tiller&quot;]
 ---&gt; Running in 9760ea4dc6c5
Removing intermediate container 9760ea4dc6c5
 ---&gt; 9384b4f39ab3
Successfully built 9384b4f39ab3
Successfully tagged jbrette/tiller-arm32v7:2.9
</code></pre>

<h3 id="cross-compiling-and-image-cration-from-travis-ci-1">Cross Compiling and Image cration from Travis-CI</h3>

<ul>
<li>WIP</li>
</ul>

<h2 id="install-tiller-and-helm-on-rpi">Install Tiller and Helm on RPI</h2>

<h3 id="install-helm-on-pi">Install helm on PI</h3>

<pre><code>ssh rpiuser@192.168.1.95
sudo cp /home/rpiuser/helm_binaries/helm /usr/bin/helm
</code></pre>

<h3 id="deploy-tiller-pod">Deploy Tiller POD</h3>

<p>First push the tiller docker image to the repo</p>

<pre><code>docker login

docker push jbrette/tiller-arm32v7:2.9
</code></pre>

<p>Prepare the POD deployment files</p>

<pre><code>mkdir -p ~/kube-deployments/tiller
cd  ~/kube-deployments/tiller
</code></pre>

<p>Create the kubectl file for tiller service account</p>

<pre><code class="language-sh">cat tiller-serviceaccount.yaml
</code></pre>

<pre><code class="language-yaml">---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: tiller
  namespace: kube-system
...
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: tiller
    namespace: kube-system
...
</code></pre>

<p>Create the tiller service account</p>

<pre><code>kubectl create -f tiller-serviceaccount.yaml

serviceaccount/tiller created
clusterrolebinding.rbac.authorization.k8s.io/tiller created
</code></pre>

<p>Create manually the tiller deployment file and leverage the tiller service account</p>

<pre><code>helm init --service-account tiller --output yaml &gt; tiller.yaml
</code></pre>

<p>Edit the image and replace <code>gcr.io/kubernetes-helm/tiller:2.9</code> by <code>jbrette/tiller-arm32v7:2.9</code></p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  creationTimestamp: null
  labels:
    app: helm
    name: tiller
  name: tiller-deploy
  namespace: kube-system
spec:
  replicas: 1
  strategy: {}
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: helm
        name: tiller
    spec:
      containers:
      - env:
        - name: TILLER_NAMESPACE
          value: kube-system
        - name: TILLER_HISTORY_MAX
          value: &quot;0&quot;
        image: gcr.io/kubernetes-helm/tiller:2.9
        imagePullPolicy: IfNotPresent
        livenessProbe:
          httpGet:
            path: /liveness
            port: 44135
          initialDelaySeconds: 1
          timeoutSeconds: 1
        name: tiller
        ports:
        - containerPort: 44134
          name: tiller
        - containerPort: 44135
          name: http
        readinessProbe:
          httpGet:
            path: /readiness
            port: 44135
          initialDelaySeconds: 1
          timeoutSeconds: 1
        resources: {}
      serviceAccountName: tiller
status: {}
</code></pre>

<p>Deploy tiller in the kubernetes cluster</p>

<pre><code>kubectl create -f tiller.yaml
</code></pre>

<p>Check the deployment state</p>

<pre><code>kubectl get all -n kube-system

NAME                                        READY     STATUS             RESTARTS   AGE
pod/tiller-deploy-b59fcc885-66l7s           1/1       Running            0          5m

NAME                                   DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/tiller-deploy          1         1         1            1           5m

NAME                                              DESIRED   CURRENT   READY     AGE
replicaset.apps/tiller-deploy-b59fcc885           1         1         1         5m
</code></pre>

<p>Check the logs</p>

<pre><code>kubectl logs pod/tiller-deploy-b59fcc885-66l7s -n kube-system

[main] 2018/07/15 18:08:10 Starting Tiller 2.9 (tls=false)
[main] 2018/07/15 18:08:10 GRPC listening on :44134
[main] 2018/07/15 18:08:10 Probes listening on :44135
[main] 2018/07/15 18:08:10 Storage driver is ConfigMap
[main] 2018/07/15 18:08:10 Max history per release is 0
</code></pre>

<h3 id="init-the-helm-client-side">Init the Helm client side</h3>

<pre><code>helm init --client-only

Creating /home/rpiuser/.helm
Creating /home/rpiuser/.helm/repository
Creating /home/rpiuser/.helm/repository/cache
Creating /home/rpiuser/.helm/repository/local
Creating /home/rpiuser/.helm/plugins
Creating /home/rpiuser/.helm/starters
Creating /home/rpiuser/.helm/cache/archive
Creating /home/rpiuser/.helm/repository/repositories.yaml
Adding stable repo with URL: https://kubernetes-charts.storage.googleapis.com
Adding local repo with URL: http://127.0.0.1:8879/charts
$HELM_HOME has been configured at /home/rpiuser/.helm.
Not installing Tiller due to 'client-only' flag having been set
Happy Helming!
</code></pre>

<p>Check helm commands are working properly</p>

<pre><code>helm ls
helm search stable/nginx-ingress
helm inspect stable/nginx-ingress
</code></pre>

<h2 id="use-helm-on-rpi">Use helm on RPI</h2>

<p>Let&rsquo;s access the simple helm repo designed for</p>

<pre><code>helm repo add kubeplay 'https://raw.githubusercontent.com/jbrette/kubeplay/arm32v7/helmrepo/'
</code></pre>

<pre><code>helm repo list

NAME            URL
stable          https://kubernetes-charts.storage.googleapis.com
local           http://127.0.0.1:8879/charts
kubeplay        https://raw.githubusercontent.com/jbrette/kubeplay/arm32v7/helmrepo/
</code></pre>

<pre><code>helm search kubeplay

NAME                            CHART VERSION   APP VERSION     DESCRIPTION
kubeplay/kubeplay-arm32v7       0.1.0           0.1.0           A Helm chart for Kubernetes
</code></pre>

<p>Install simple hello world helm chart from kubeplay</p>

<pre><code>helm install kubeplay/kubeplay-arm32v7 --name helm-rpi

NAME:   helm-rpi
LAST DEPLOYED: Sun Jul 15 19:23:58 2018
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==&gt; v1/Service
NAME                       TYPE      CLUSTER-IP     EXTERNAL-IP  PORT(S)         AGE
helm-rpi-kubeplay-arm32v7  NodePort  10.96.168.184  &lt;none&gt;       8005:31439/TCP  2s

==&gt; v1beta1/Deployment
NAME                       DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE
helm-rpi-kubeplay-arm32v7  1        0        0           0          2s
</code></pre>

<p>Check the installation</p>

<pre><code>helm ls

NAME            REVISION        UPDATED                         STATUS          CHART                   NAMESPACE
helm-rpi        1               Sun Jul 15 19:23:58 2018        DEPLOYED        kubeplay-arm32v7-0.1.0  default
</code></pre>

<p>Check with kubectl if the POD is ready</p>

<pre><code>kubectl get all -n default

NAME                                             READY     STATUS    RESTARTS   AGE
pod/helm-rpi-kubeplay-arm32v7-58567c4756-fj968   0/1       Running   4          4m

NAME                                TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE
service/helm-rpi-kubeplay-arm32v7   NodePort    10.96.168.184   &lt;none&gt;        8005:31439/TCP   4m
service/kubernetes                  ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP          9d

NAME                                        DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/helm-rpi-kubeplay-arm32v7   1         1         1            0           4m

NAME                                                   DESIRED   CURRENT   READY     AGE
replicaset.apps/helm-rpi-kubeplay-arm32v7-58567c4756   1         1         0         4m
</code></pre>

<p>Helm chart is not really consistent. Current image hardcoded to listen on port 80
Let&rsquo;s use helm upgrade to change the value</p>

<pre><code>helm upgrade --set service.internalPort=80 helm-rpi kubeplay/kubeplay-arm32v7

Release &quot;helm-rpi&quot; has been upgraded. Happy Helming!
LAST DEPLOYED: Sun Jul 15 20:39:17 2018
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==&gt; v1beta1/Deployment
NAME                       DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE
helm-rpi-kubeplay-arm32v7  1        1        0           0          1h

==&gt; v1/Pod(related)
NAME                                        READY  STATUS       RESTARTS  AGE
helm-rpi-kubeplay-arm32v7-58567c4756-fj968  0/1    Terminating  25        1h
helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m  0/1    Pending      0         0s

==&gt; v1/Service
NAME                       TYPE      CLUSTER-IP     EXTERNAL-IP  PORT(S)         AGE
helm-rpi-kubeplay-arm32v7  NodePort  10.96.168.184  &lt;none&gt;       8005:31439/TCP  1h
</code></pre>

<p>The pod seems to now be running properly.</p>

<pre><code>kubectl get all -n default

NAME                                             READY     STATUS    RESTARTS   AGE
pod/helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m   1/1       Running   0          3m

NAME                                TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE
service/helm-rpi-kubeplay-arm32v7   NodePort    10.96.168.184   &lt;none&gt;        8005:31439/TCP   1h
service/kubernetes                  ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP          9d

NAME                                        DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/helm-rpi-kubeplay-arm32v7   1         1         1            1           1h

NAME                                                   DESIRED   CURRENT   READY     AGE
replicaset.apps/helm-rpi-kubeplay-arm32v7-58567c4756   0         0         0         1h
replicaset.apps/helm-rpi-kubeplay-arm32v7-6cb66496c6   1         1         1         3m
</code></pre>

<p>Check the POD</p>

<pre><code>$ kubectl describe pod/helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m
Name:           helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m
Namespace:      default
Node:           nas-pi/192.168.1.93
Start Time:     Sun, 15 Jul 2018 20:39:18 +0000
Labels:         app=kubeplay-arm32v7
                pod-template-hash=2762205272
                release=helm-rpi
Annotations:    &lt;none&gt;
Status:         Running
IP:             10.244.2.6
Controlled By:  ReplicaSet/helm-rpi-kubeplay-arm32v7-6cb66496c6
Containers:
  kubeplay-arm32v7:
    Container ID:   docker://737cd78bebb982c782dae2c07f4604ba71f45bc112e91aa20652e29b25bf5d63
    Image:          jbrette/kubeplay-arm32v7:0.1.0
    Image ID:       docker-pullable://jbrette/kubeplay-arm32v7@sha256:86441999035e35514fc647ff9af90bdfc152299636b48b9d3dba9107574f3957
    Port:           80/TCP
    Host Port:      0/TCP
    State:          Running
      Started:      Sun, 15 Jul 2018 20:39:23 +0000
    Ready:          True
    Restart Count:  0
    Liveness:       http-get http://:80/ delay=0s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:80/ delay=0s timeout=1s period=10s #success=1 #failure=3
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-c5v7s (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  default-token-c5v7s:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-c5v7s
    Optional:    false
QoS Class:       BestEffort
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute for 300s
                 node.kubernetes.io/unreachable:NoExecute for 300s
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  10m   default-scheduler  Successfully assigned default/helm-rpi-kubeplay-arm32v7-6cb66496c6-9w97m to nas-pi
  Normal  Pulling    10m   kubelet, nas-pi    pulling image &quot;jbrette/kubeplay-arm32v7:0.1.0&quot;
  Normal  Pulled     10m   kubelet, nas-pi    Successfully pulled image &quot;jbrette/kubeplay-arm32v7:0.1.0&quot;
  Normal  Created    10m   kubelet, nas-pi    Created container
  Normal  Started    10m   kubelet, nas-pi    Started container
</code></pre>

<p>Let&rsquo;s open a browser towards the URL:</p>

<p><img src="/images/kubeplay/kubeplay_arm32v7.png" alt="" />
<img src="/images/kubeplay/dashboard.png" alt="" /></p>

<h2 id="conclusion">Conclusion</h2>

<ul>
<li>Need to cleanup the helm chart and docker image to ensure consistency of the internal</li>
<li>Need to improve the NodePort/ClusterIP/LoadBalancer handling.</li>
</ul>

<h2 id="reference-links">Reference Links</h2>

<ul>
<li><a href="https://github.com/jonaseck2/rpi-helm">Usage of remote API</a></li>
</ul>

<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/pi_cluster/maintenance/" title="Helm &amp; Maintenance"> <i class="fas fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/pi_cluster/maintenance/children/2018-07-11-a/" title="Use github repo as helm chart repository" style="margin-right: 0px;"><i class="fas fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1540758761"></script>
    <script src="/js/perfect-scrollbar.min.js?1540758761"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1540758761"></script>
    <script src="/js/jquery.sticky.js?1540758761"></script>
    <script src="/js/featherlight.min.js?1540758761"></script>
    <script src="/js/html5shiv-printshiv.min.js?1540758761"></script>
    <script src="/js/highlight.pack.js?1540758761"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1540758761"></script>
    <script src="/js/learn.js?1540758761"></script>
    <script src="/js/hugo-learn.js?1540758761"></script>

    <link href="/mermaid/mermaid.css?1540758761" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1540758761"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

